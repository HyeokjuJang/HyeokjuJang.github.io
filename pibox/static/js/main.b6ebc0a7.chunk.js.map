{"version":3,"sources":["Tfjs.js","ProgressBar.js","BlockCode.js","PythonCodeBase.js","BluetoothConnect.js","App.js","index.js","uuid.js"],"names":["TfMain","camera","machineId","ipAddress","setProbability","console","log","this","infoTexts","data","label","training","videoPlaying","trained","inputFirst","isTraining","numClasses","completeModel","exampleCount","Array","fill","lastChildAddClass","result","resultConfidence","piboxPy","body","document","undefined","current","bindPage","video","createElement","appendChild","i","div","style","marginBottom","button","innerText","addEventListener","infoText","push","src","width","height","crossOrigin","tf","mobilenet","layer","getLayer","inputs","outputs","output","loadMobileNet","trainable","predict","start","timer","stop","tagName","play","requestAnimationFrame","animate","bind","pause","cancelAnimationFrame","length","trainButton","getElementById","labels","model","denseLayer1","dense","inputShape","shape","slice","units","activation","use_bias","kernel_initializer","denseLayer2","add","compile","optimizer","adam","loss","metrics","forEach","e","parseInt","oldLabels","concat","dispose","fit","epochs","batchSize","callbacks","onBatchEnd","batch","logs","acc","then","info","history","save","http","requestInit","method","headers","machine_id","image","IMAGE_SIZE","canvasEl","toString","canvas","className","insertBefore","firstChild","childNodes","removeChild","lastChild","ctx","getContext","imageData","ImageData","dataSync","j","putImageData","nowClass","ms","Promise","resolve","setTimeout","fromPixels","resizeBilinear","infer","expandDims","toFloat","sub","newX","oldData","draw","logits","predictedClass","as1D","argMax","res","confidence","fontWeight","Math","round","sleep","ProgressBar","props","bgcolor","completed","fillerStyles","backgroundColor","borderRadius","textAlign","margin","padding","color","BlockCode","useState","setLabels","ch1OutputType","setCh1OutputType","ch2OutputType","setCh2OutputType","ch1OutputAmount","setCh1OutputAmount","ch2OutputAmount","setCh2OutputAmount","tfFunc","setTfFunc","moveMotorThreshold","checkMove","setCheckMove","piboxUploadBtnName","setPiboxUploadBtnName","checkTime","setCheckTime","probability","useRef","useEffect","getSetOutput","setOutputContext","getIfContext","chk","context","index","func","noOutputCh1","noOutputCh2","isNaN","parseFloat","r","g","b","getBackContext","back","downloadPy","a","download","front2","middleIf","file","Blob","type","piForm","FormData","append","fetch","mode","cache","credentials","redirect","referrer","sendCommand","uploadUUID","error","sendMoving","alert","Date","now","url","ch1Command","ch2Command","callback","delay","savedCallback","id","setInterval","clearInterval","useInterval","onClick","setIsBlockCoding","display","marginLeft","position","ref","train","cursor","marginRight","state","alt","map","key","floor","top","onMouseDown","addTrainingData","onMouseUp","onMouseLeave","size","noshade","marginTop","onChange","value","target","newState","fontSize","defaultValue","rgb","onChangeComplete","selectOutputMount","addClass","BluetoothConnect","connectDevice","navigator","bluetooth","requestDevice","filters","services","UUID","SERVICE_ID","device","gatt","connect","server","setState","serverId","getPrimaryService","service","isIphone","webBleConnect","getCharacteristics","characteristics","characteristicsList","isConnected","infoList","preset","uuid","DEVICE_MODEL","WIFI_NAME","IP_ADDRESS","subscribeCharacteristic","readInfoCharacteristic","NOTIFY_MESSAGE","CUSTOM_COMMAND_NOTIFY","filter","indexOf","CUSTOM_INFO_LABEL","item","replace","CUSTOM_INFO","uuid_label","tempCharList","CUSTOM_COMMAND_LABEL","commandList","readCommandLabel","catch","getCharacteristicInit","readValue","buffer","ab2str","tempCMDList","find","tempInfoList","event","msg","notify","show","commandOutputShouldRefresh","commandOutput","endsWith","startNotifications","getCharacteristic","PREFIX","CUSTOM_INFO_COUNT","characteristic","customInfoCount","CUSTOM_COMMAND_COUNT","customCommandCount","customInfoList","ending","repeat","customCommandList","all","SERVICE_NAME","INPUT_SEP","CUSTOM_COMMAND_INPUT","buf","String","fromCharCode","apply","Uint8Array","inputWifi","trim","ssid","password","errMsg","wifiLock","wifiReset","sendArray","str2abs","sendSeparately","array","writeValue","wait","sec","waitCamera","resp","ok","str","val","charCodeAt","valArray","split","bufferArray","splice","join","match","h","setIsBlockCodingToFalse","isBlockCoding","c","supportBluetooth","Boolean","window","loading","charLength","isAndroid","userAgent","wifiConnected","toLowerCase","href","placeholder","disabled","React","Component","App","ReactDOM","render","module","exports","INPUT"],"mappings":"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","file":"static/js/main.b6ebc0a7.chunk.js","sourcesContent":["// Copyright 2018 Google LLC\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     https://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport * as tf from \"@tensorflow/tfjs\";\r\n\r\n// Number of classes to classify\r\nconst NUM_CLASSES = 2;\r\n// Webcam Image size. Must be 224.\r\nconst IMAGE_SIZE = 96;\r\n\r\nexport class TfMain {\r\n  constructor(camera, machineId, ipAddress, setProbability) {\r\n    console.log(machineId);\r\n    // Initiate variables\r\n    this.infoTexts = [];\r\n    this.data = null;\r\n    this.label = [];\r\n    this.training = -1; // -1 when no class is being trained\r\n    this.videoPlaying = false;\r\n    this.trained = false;\r\n    this.inputFirst = true;\r\n    this.isTraining = false;\r\n    this.ipAddress = ipAddress;\r\n    this.numClasses = NUM_CLASSES;\r\n    this.completeModel = null;\r\n    this.exampleCount = new Array(NUM_CLASSES).fill(0);\r\n    this.lastChildAddClass = null;\r\n    this.machineId = machineId;\r\n    this.result = -1;\r\n    this.resultConfidence = 0;\r\n    this.piboxPy = \"\";\r\n    this.setProbability = setProbability;\r\n\r\n    this.body = document.body;\r\n    if (camera.current !== undefined) {\r\n      this.body = camera.current;\r\n    }\r\n\r\n    this.bindPage();\r\n\r\n    // // Create video element that will contain the webcam image\r\n    // this.video = document.createElement(\"video\");\r\n    // this.video.setAttribute(\"autoplay\", \"\");\r\n    // this.video.setAttribute(\"playsinline\", \"\");\r\n\r\n    // Create image element for picamera streaming\r\n    this.video = document.createElement(\"img\");\r\n\r\n    // Add video element to DOM\r\n    this.body.appendChild(this.video);\r\n\r\n    // Create training buttons and info texts\r\n    for (let i = 0; i < this.numClasses; i++) {\r\n      const div = document.createElement(\"div\");\r\n      this.lastChildAddClass = div;\r\n      this.body.appendChild(div);\r\n\r\n      div.style.marginBottom = \"10px\";\r\n\r\n      // Create training button\r\n      const button = document.createElement(\"button\");\r\n      button.innerText = \"데이터 추가 - 클래스 \" + (i + 1);\r\n      //div.appendChild(button);\r\n\r\n      // Listen for mouse events when clicking the button\r\n      button.addEventListener(\"mousedown\", () => (this.training = i));\r\n      button.addEventListener(\"mouseup\", () => (this.training = -1));\r\n\r\n      // Create info text\r\n      const infoText = document.createElement(\"span\");\r\n      infoText.innerText = \" 추가된 데이터가 없습니다.\";\r\n      //div.appendChild(infoText);\r\n      this.infoTexts.push(infoText);\r\n    }\r\n\r\n    // let div = document.createElement(\"div\");\r\n    // this.lastChildAddClass = div;\r\n    // this.body.appendChild(div);\r\n    // div.style.marginBottom = \"10px\";\r\n\r\n    // Create training button\r\n    // let button = document.createElement(\"button\");\r\n    // button.innerText = \"PLAi 학습하기\";\r\n    // button.id = \"trainButton\";\r\n    // div.appendChild(button);\r\n\r\n    // Listen for mouse events when clicking the button\r\n    // button.addEventListener(\"mouseup\", () => this.train());\r\n\r\n    // div = document.createElement(\"div\");\r\n    // this.body.appendChild(div);\r\n    // div.style.marginBottom = \"10px\";\r\n\r\n    // Create training button\r\n    // button = document.createElement(\"button\");\r\n    // button.innerText = \"학습한 모델 저장\";\r\n    // button.id = \"modelSave\";\r\n    // div.appendChild(button);\r\n\r\n    // Listen for mouse events when clicking the button\r\n    // button.addEventListener(\"mouseup\", () => {\r\n    //   this.download();\r\n    // });\r\n\r\n    //using webcam\r\n    if (0) {\r\n      // Setup webcam\r\n      navigator.mediaDevices\r\n        .getUserMedia({\r\n          video: { width: IMAGE_SIZE, height: IMAGE_SIZE },\r\n          audio: false,\r\n        })\r\n        .then((stream) => {\r\n          this.video.srcObject = stream;\r\n          this.video.width = IMAGE_SIZE;\r\n          this.video.height = IMAGE_SIZE;\r\n\r\n          this.video.addEventListener(\"playing\", () => (this.videoPlaying = true));\r\n          this.video.addEventListener(\"paused\", () => (this.videoPlaying = false));\r\n        });\r\n    }\r\n    //using picamera\r\n    if (1) {\r\n      this.video.src = \"http://\" + this.ipAddress + \":8000/stream.mjpg\";\r\n      this.video.width = 224;\r\n      this.video.height = 224;\r\n      this.video.crossOrigin = \"anonymous\";\r\n    }\r\n  }\r\n\r\n  addTrainingData(label) {\r\n    this.training = label;\r\n  }\r\n\r\n  async loadMobileNet() {\r\n    const mobilenet = await tf.loadLayersModel(`./assets/${IMAGE_SIZE}_0.35/model.json`);\r\n    const layer = mobilenet.getLayer(IMAGE_SIZE === 160 ? \"global_average_pooling2d\" : \"global_average_pooling2d_1\");\r\n    return tf.model({ inputs: mobilenet.inputs, outputs: layer.output });\r\n  }\r\n\r\n  async bindPage() {\r\n    this.mobilenet = await this.loadMobileNet();\r\n    this.mobilenet.trainable = false;\r\n    this.mobilenet.predict(tf.zeros([1, IMAGE_SIZE, IMAGE_SIZE, 3]));\r\n\r\n    //tf.setBackend(\"webgl\");\r\n    //console.log(this.model.summary());\r\n\r\n    this.start();\r\n  }\r\n\r\n  start() {\r\n    if (this.timer) {\r\n      this.stop();\r\n    }\r\n    if (this.video.tagName === \"video\") this.video.play();\r\n    else this.videoPlaying = true;\r\n    this.timer = requestAnimationFrame(this.animate.bind(this));\r\n  }\r\n\r\n  stop() {\r\n    if (this.video.tagName === \"video\") this.video.pause();\r\n    this.videoPlaying = false;\r\n    cancelAnimationFrame(this.timer);\r\n  }\r\n\r\n  train() {\r\n    if (!this.isTraining && this.label.length !== 0) {\r\n      this.isTraining = true;\r\n      const trainButton = document.getElementById(\"trainButton\");\r\n      //trainButton.innerText = \"잠시 기다려주세요...\";\r\n      //trainButton.disabled = true;\r\n      trainButton.src = \"img/plai_training.svg\";\r\n      console.log(\"train start\");\r\n\r\n      let labels = null;\r\n      this.model = tf.sequential();\r\n      this.denseLayer1 = tf.layers.dense({\r\n        inputShape: this.mobilenet.outputs[0].shape.slice(1),\r\n        units: 100,\r\n        activation: \"relu\",\r\n        use_bias: true,\r\n        kernel_initializer: \"varianceScaling\",\r\n      });\r\n      this.denseLayer2 = tf.layers.dense({\r\n        units: this.numClasses,\r\n        activation: \"softmax\",\r\n        use_bias: false,\r\n        kernel_initializer: \"varianceScaling\",\r\n      });\r\n\r\n      this.model.add(this.denseLayer1);\r\n      this.model.add(this.denseLayer2);\r\n      this.model.compile({\r\n        optimizer: tf.train.adam(0.0001),\r\n        loss: \"categoricalCrossentropy\",\r\n        metrics: [\"accuracy\"],\r\n      });\r\n\r\n      this.label.forEach((e) => {\r\n        const label = tf.oneHot(tf.tensor1d([parseInt(e)], \"int32\"), this.numClasses);\r\n        if (labels === null) labels = label;\r\n        else {\r\n          const oldLabels = labels;\r\n          labels = oldLabels.concat(label, 0);\r\n          oldLabels.dispose();\r\n        }\r\n      });\r\n      //this.data.print();\r\n      //labels.print();\r\n      function onBatchEnd(batch, logs) {\r\n        console.log(\"Accuracy\", logs.acc);\r\n      }\r\n      this.model\r\n        .fit(this.data, labels, {\r\n          epochs: 20,\r\n          batchSize: parseInt(this.label.length * 0.4),\r\n          callbacks: { onBatchEnd },\r\n        })\r\n        .then((info) => {\r\n          console.log(\"Final accuracy\", info.history.acc);\r\n          this.trained = true;\r\n          this.isTraining = false;\r\n          trainButton.src = \"img/plai_train.svg\";\r\n          //trainButton.innerText = \"PLAi 학습하기\";\r\n          //trainButton.disabled = false;\r\n        });\r\n    }\r\n  }\r\n\r\n  async download() {\r\n    // const saveButton = document.getElementById(\"modelSave\");\r\n    // saveButton.innerText = \"잠시 기다려주세요...\";\r\n    // saveButton.disabled = true;\r\n    this.completeModel = tf.sequential();\r\n    this.completeModel.add(this.mobilenet);\r\n    try {\r\n      this.completeModel.add(this.model);\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      //await this.completeModel.save(\"downloads://model\");\r\n      await this.completeModel.save(\r\n        tf.io.http(\"http://tfjson-to-tflite.unicityclean.com/upload\", {\r\n          //tf.io.http(\"http://tfjson-to-tflite-2053599458.ap-northeast-2.elb.amazonaws.com/upload\", {\r\n          requestInit: {\r\n            method: \"POST\",\r\n            headers: { machine_id: this.machineId },\r\n          },\r\n        })\r\n      );\r\n      // saveButton.innerText = \"(성공)학습한 모델 저장\";\r\n      // saveButton.disabled = false;\r\n      return true;\r\n    } catch (error) {\r\n      // saveButton.innerText = \"(실패)학습한 모델 저장\";\r\n      // saveButton.disabled = false;\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async draw(image, label) {\r\n    const [width, height] = [IMAGE_SIZE / 2, IMAGE_SIZE / 2];\r\n    const canvasEl = document.getElementById(\"canvas-\" + label.toString());\r\n    const canvas = document.createElement(\"canvas\");\r\n\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    canvas.className = \"cameraData\";\r\n    canvasEl.insertBefore(canvas, canvasEl.firstChild);\r\n    if (canvasEl.childNodes.length > 25) canvasEl.removeChild(canvasEl.lastChild);\r\n    const ctx = canvas.getContext(\"2d\");\r\n    const imageData = new ImageData(width, height);\r\n    const data = image.dataSync();\r\n    for (let i = 0; i < height * width; ++i) {\r\n      const j = i * 4;\r\n      imageData.data[j + 0] = (data[i * 3 + 0] + 1) * 127;\r\n      imageData.data[j + 1] = (data[i * 3 + 1] + 1) * 127;\r\n      imageData.data[j + 2] = (data[i * 3 + 2] + 1) * 127;\r\n      imageData.data[j + 3] = 255;\r\n    }\r\n    ctx.putImageData(imageData, 0, 0);\r\n  }\r\n\r\n  addClass() {\r\n    this.exampleCount.push(0);\r\n    this.numClasses += 1;\r\n    const div = document.createElement(\"div\");\r\n\r\n    this.body.insertBefore(div, this.lastChildAddClass);\r\n\r\n    div.style.marginBottom = \"10px\";\r\n\r\n    // Create training button\r\n    const button = document.createElement(\"button\");\r\n    button.innerText = \"데이터 추가 - 클래스 \" + this.numClasses;\r\n    //div.appendChild(button);\r\n    const nowClass = this.numClasses;\r\n    // Listen for mouse events when clicking the button\r\n    button.addEventListener(\"mousedown\", () => (this.training = nowClass - 1));\r\n    button.addEventListener(\"mouseup\", () => (this.training = -1));\r\n\r\n    // Create info text\r\n    const infoText = document.createElement(\"span\");\r\n    infoText.innerText = \" 추가된 데이터가 없습니다.\";\r\n    //div.appendChild(infoText);\r\n    this.infoTexts.push(infoText);\r\n  }\r\n\r\n  sleep(ms) {\r\n    return new Promise((resolve) => setTimeout(resolve, ms));\r\n  }\r\n\r\n  async animate() {\r\n    if (this.videoPlaying) {\r\n      // Get image data from video element\r\n      const image = tf.browser.fromPixels(this.video).resizeBilinear([96, 96]);\r\n\r\n      let logits;\r\n      // 'conv_preds' is the logits activation of MobileNet.\r\n      const infer = () => tf.tidy(() => this.model.predict(this.mobilenet.predict(image.expandDims(0).toFloat().div(127).sub(1))));\r\n\r\n      // Train class if one of the buttons is held down\r\n      if (this.training !== -1) {\r\n        const newX = image.expandDims(0).toFloat().div(127).sub(1);\r\n        // Add current image to classifier\r\n        if (!this.inputFirst) {\r\n          const oldData = this.data;\r\n          this.data = oldData.concat(this.mobilenet.predict(newX), 0);\r\n          this.label.push(this.training);\r\n          oldData.dispose();\r\n        } else {\r\n          this.data = this.mobilenet.predict(newX);\r\n          this.label.push(this.training);\r\n          this.inputFirst = false;\r\n        }\r\n        await this.draw(newX.resizeBilinear([48, 48]), this.training);\r\n        this.exampleCount[this.training] += 1;\r\n        newX.dispose();\r\n      }\r\n\r\n      //if (hasClass(this.data.map(e => e.length)) > 0) {\r\n      if (this.trained) {\r\n        // If classes have been added run predict\r\n        logits = infer();\r\n        const predictedClass = logits.as1D().argMax();\r\n\r\n        const res = (await predictedClass.data())[0];\r\n        const confidence = await logits.data();\r\n        this.setProbability(confidence);\r\n        for (let i = 0; i < this.numClasses; i++) {\r\n          // Make the predicted class bold\r\n          if (res === i) {\r\n            this.infoTexts[i].style.fontWeight = \"bold\";\r\n            this.result = i;\r\n            this.resultConfidence = confidence[i] * 100;\r\n          } else {\r\n            this.infoTexts[i].style.fontWeight = \"normal\";\r\n          }\r\n          if (this.exampleCount[i] > 0) {\r\n            this.infoTexts[i].innerText = ` ${this.exampleCount[i]} examples - ${Math.round(confidence[i] * 100)}%`;\r\n          }\r\n        }\r\n        predictedClass.dispose();\r\n      } else {\r\n        for (let i = 0; i < this.numClasses; i++) {\r\n          // The number of examples for each class\r\n\r\n          // Update info text\r\n          if (this.exampleCount[i] > 0) {\r\n            this.infoTexts[i].innerText = ` ${this.exampleCount[i]} examples`;\r\n          }\r\n        }\r\n      }\r\n\r\n      // Dispose image when done\r\n      image.dispose();\r\n      if (logits != null) {\r\n        logits.dispose();\r\n      }\r\n    }\r\n    await this.sleep(30);\r\n    this.timer = requestAnimationFrame(this.animate.bind(this));\r\n  }\r\n}\r\n\r\n//window.addEventListener(\"load\", () => new Main());\r\n","import React from \"react\";\r\nconst ProgressBar = (props) => {\r\n  const { bgcolor, completed } = props;\r\n\r\n  const containerStyles = {\r\n    height: 20,\r\n    width: \"100%\",\r\n    backgroundColor: \"#ffffff\",\r\n    borderRadius: 50,\r\n    margin: 8,\r\n  };\r\n\r\n  const fillerStyles = {\r\n    height: \"100%\",\r\n    width: `${completed}%`,\r\n    backgroundColor: bgcolor,\r\n    borderRadius: \"inherit\",\r\n    textAlign: \"right\",\r\n    //transition: \"width 0.5s ease-in-out\",\r\n  };\r\n\r\n  const labelStyles = {\r\n    padding: 5,\r\n    color: \"#ffffff\",\r\n    fontWeight: \"bold\",\r\n  };\r\n\r\n  return (\r\n    <div style={containerStyles}>\r\n      <div style={fillerStyles}>\r\n        <span style={labelStyles}>{`${completed}%`}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgressBar;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { SliderPicker } from \"react-color\";\r\nimport { TfMain } from \"./Tfjs\";\r\nimport { front, middle } from \"./PythonCodeBase\";\r\nimport ProgressBar from \"./ProgressBar\";\r\n\r\nexport default function BlockCode(props) {\r\n  let fileReader;\r\n  const [labels, setLabels] = useState([\"Class 01\", \"Class 02\"]);\r\n  const [ch1OutputType, setCh1OutputType] = useState(0);\r\n  const [ch2OutputType, setCh2OutputType] = useState(0);\r\n  const [ch1OutputAmount, setCh1OutputAmount] = useState([]);\r\n  const [ch2OutputAmount, setCh2OutputAmount] = useState([]);\r\n  const [tfFunc, setTfFunc] = useState(null);\r\n  const [moveMotorThreshold, setMoveMotorThreshold] = useState(80);\r\n  const [checkMove, setCheckMove] = useState(false);\r\n  const [piboxUploadBtnName, setPiboxUploadBtnName] = useState(\"블록코드 업로드\");\r\n  const [checkTime, setCheckTime] = useState(0);\r\n  const [probability, setProbability] = useState([0, 0]);\r\n  const camera = useRef(\"\");\r\n  const piboxUploadBtn = useRef(\"\");\r\n\r\n  useEffect(() => {\r\n    if (camera.current !== undefined && props.machineId !== \"\") {\r\n      setTfFunc(new TfMain(camera, props.machineId, props.ipAddress, setProbability));\r\n      setCh1OutputAmount(new Array(2).fill(\"\"));\r\n      setCh2OutputAmount(new Array(2).fill(\"\"));\r\n    } // eslint-disable-next-line\r\n  }, [camera, props.machineId]);\r\n\r\n  const uploadFile = (file) => {\r\n    // 파일이 입력되면 먼저 여기로 들어오게된다.\r\n    // 파일입력이 없음에도 들어오면 바로 컷\r\n    if (file === undefined) {\r\n      return;\r\n    }\r\n\r\n    fileReader = new FileReader();\r\n\r\n    fileReader.onloadend = () => {\r\n      const content = fileReader.result;\r\n      const result = [];\r\n      content.split(\"\\n\").forEach((label) => {\r\n        result.push(label.substr(2));\r\n        console.log(label);\r\n      });\r\n      if (result[result.length - 1] === \"\") {\r\n        result.pop();\r\n      }\r\n      setLabels(result);\r\n      setCh1OutputType(0);\r\n      setCh2OutputType(0);\r\n      setCh1OutputAmount(new Array(result.length).fill(\"\"));\r\n      setCh2OutputAmount(new Array(result.length).fill(\"\"));\r\n    };\r\n    fileReader.readAsText(file);\r\n  };\r\n\r\n  function addClass() {\r\n    tfFunc.addClass();\r\n    setLabels((state) => [...state, `Class ${labels.length + 1}`]);\r\n    setCh1OutputAmount((state) => [...state, \"\"]);\r\n    setCh2OutputAmount((state) => [...state, \"\"]);\r\n    setProbability((state) => [...state, 0]);\r\n  }\r\n\r\n  function getSetOutput() {\r\n    let setOutputContext = `GPIO.setmode(GPIO.BCM)\r\npwm = pigpio.pi() \r\n    `;\r\n    // 서보모터\r\n    if (ch1OutputType === 1)\r\n      setOutputContext += `\r\npwm.set_mode(18, pigpio.OUTPUT)\r\n`;\r\n    else if (ch1OutputType === 2)\r\n      setOutputContext += `\r\nGPIO.setup(18,GPIO.OUT) # Channel 1 Speed\r\nGPIO.setup(23,GPIO.OUT) # Direction of Channel 1\r\nGPIO.output(23,0) \r\nm1=GPIO.PWM(18,50)\r\nm1.start(0)\r\n`;\r\n    else if (ch1OutputType === 3 && ch2OutputType !== 3)\r\n      setOutputContext += `\r\npix1 = neopixel.NeoPixel(board.D18,12)\r\n`;\r\n    // 서보모터\r\n    if (ch2OutputType === 1)\r\n      setOutputContext += `\r\npwm.set_mode(12, pigpio.OUTPUT)\r\n`;\r\n    else if (ch2OutputType === 2)\r\n      setOutputContext += `\r\nGPIO.setup(12,GPIO.OUT) # Channel 2 Speed\r\nGPIO.setup(25,GPIO.OUT)\r\nGPIO.output(25,0) # Direction of Channel 2\r\nm2=GPIO.PWM(12,50)\r\nm2.start(0)\r\n`;\r\n    else if (ch2OutputType === 3 && ch1OutputType !== 3)\r\n      setOutputContext += `\r\npix2 = neopixel.NeoPixel(board.D12,12)\r\n`;\r\n    return setOutputContext;\r\n  }\r\n  function getIfContext() {\r\n    let chk = 0;\r\n    let context = `    # From here. the block code\r\n    resultIndex = np.argmax(result)\r\n`;\r\n    labels.forEach((label, index) => {\r\n      let func = \"\";\r\n      let noOutputCh1 = false;\r\n      let noOutputCh2 = false;\r\n      if (ch1OutputType === 0) noOutputCh1 = true;\r\n      else if (ch1OutputType === 1) {\r\n        if (isNaN(parseFloat(ch1OutputAmount[index]))) noOutputCh1 = true;\r\n        else\r\n          func += `pwm.set_servo_pulsewidth(18,${(parseFloat(ch1OutputAmount[index]) / 180) * 2000 + 500}) # 500 => 0 deg / 1500 => 90 deg / 2500 => 180 deg\r\n        `;\r\n      }\r\n      // 서보모터\r\n      else if (ch1OutputType === 2)\r\n        func += `m1.ChangeDutyCycle(${ch1OutputAmount[index][1]})\r\n        GPIO.output(23,${ch1OutputAmount[index][0]}) # Control direction\r\n        ${\r\n          ch2OutputType === 2\r\n            ? \"\"\r\n            : `time.sleep(${ch1OutputAmount[index][2]})\r\n        m1.ChangeDutyCycle(0)\r\n        GPIO.output(23,0)\r\n        `\r\n        }\r\n        `;\r\n      // 모터\r\n      else if (ch1OutputType === 3)\r\n        func += `pix1.fill((${ch1OutputAmount[index].r},${ch1OutputAmount[index].g},${ch1OutputAmount[index].b}))\r\n        pix1.show()\r\n        `;\r\n      // LED\r\n      else noOutputCh1 = true;\r\n      if (ch2OutputType === 0) noOutputCh2 = true;\r\n      else if (ch2OutputType === 1) {\r\n        if (isNaN(parseFloat(ch2OutputAmount[index]))) noOutputCh2 = true;\r\n        else\r\n          func += `pwm.set_servo_pulsewidth(12,${(parseFloat(ch2OutputAmount[index]) / 180) * 2000 + 500}) # 500 => 0 deg / 1500 => 90 deg / 2500 => 180 deg\r\n        `;\r\n      }\r\n      // 서보모터\r\n      else if (ch2OutputType === 2)\r\n        func += `m2.ChangeDutyCycle(${ch2OutputAmount[index][1]})\r\n        GPIO.output(25,${ch2OutputAmount[index][0]}) # Control direction\r\n        time.sleep(${ch2OutputAmount[index][2]})\r\n        ${\r\n          ch1OutputType === 2\r\n            ? `m1.ChangeDutyCycle(0)\r\n        GPIO.output(23,0)`\r\n            : \"\"\r\n        }\r\n        m2.ChangeDutyCycle(0)\r\n        GPIO.output(25,0)\r\n        `;\r\n      // 모터\r\n      else if (ch2OutputType === 3)\r\n        func += `pix2.fill((${ch2OutputAmount[index].r},${ch2OutputAmount[index].g},${ch2OutputAmount[index].b}))\r\n        pix2.show()\r\n        `;\r\n      // LED\r\n      else noOutputCh2 = true;\r\n      if (noOutputCh1 === true && noOutputCh2 === true) return;\r\n      if (ch1OutputType === 1 && ch1OutputAmount[index] !== \"\")\r\n        if (chk === 0) {\r\n          context += `\r\n    if `;\r\n          chk = 1;\r\n        } else\r\n          context += `\r\n    elif `;\r\n      context += `resultIndex == ${index}:\r\n        ${func}\r\n        `;\r\n    });\r\n    return context;\r\n  }\r\n  function getBackContext() {\r\n    let back = `\r\n# Clean up\r\ncv2.destroyAllWindows()\r\nvideostream.stop()\r\n`;\r\n\r\n    if (ch1OutputType === 1 || ch2OutputType === 1) {\r\n      back += `pwm.stop()\r\n`;\r\n    }\r\n    if (ch1OutputType === 2) {\r\n      back += `m1.stop()\r\n`;\r\n    }\r\n    if (ch2OutputType === 2) {\r\n      back += `m2.stop()\r\n`;\r\n    }\r\n    back += `GPIO.cleanup()\r\n`;\r\n    return back;\r\n  }\r\n  const downloadPy = async () => {\r\n    setPiboxUploadBtnName(\"잠시만 기다려주세요...\");\r\n    //piboxUploadBtn.current.disabled = true;\r\n    const isModel = await tfFunc.download();\r\n    if (!isModel) {\r\n      return;\r\n    }\r\n    //const element = document.createElement(\"a\");\r\n    const front2 = getSetOutput();\r\n    const middleIf = getIfContext();\r\n    const back = getBackContext();\r\n    const file = new Blob([front, front2, middle, middleIf, back], {\r\n      type: \"text/plain\",\r\n    });\r\n    // element.href = URL.createObjectURL(file);\r\n    // element.download = \"pibox.py\";\r\n    // document.body.appendChild(element); // Required for this to work in FireFox\r\n    //element.click();\r\n    const piForm = new FormData();\r\n    piForm.append(\"pibox\", file, \"pibox.py\");\r\n    try {\r\n      fetch(\"http://tfjson-to-tflite.unicityclean.com/pibox\", {\r\n        method: \"POST\", // *GET, POST, PUT, DELETE, etc.\r\n        mode: \"cors\", // no-cors, cors, *same-origin\r\n        cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\r\n        credentials: \"same-origin\", // include, *same-origin, omit\r\n        headers: {\r\n          machine_id: props.machineId,\r\n        },\r\n        redirect: \"follow\", // manual, *follow, error\r\n        referrer: \"no-referrer\", // no-referrer, *client\r\n        body: piForm,\r\n      })\r\n        .then(() => {\r\n          props.sendCommand(props.uploadUUID);\r\n        })\r\n        .then(() => {\r\n          setPiboxUploadBtnName(\"블록코드 업로드\");\r\n          //piboxUploadBtn.current.disabled = false;\r\n        });\r\n    } catch (error) {\r\n      console.log(error);\r\n      setPiboxUploadBtnName(\"업로드 실패, 나중에 다시 시도해주세요.\");\r\n      //piboxUploadBtn.current.disabled = false;\r\n    }\r\n\r\n    return file;\r\n  };\r\n\r\n  //   function downloadBat(os) {\r\n  //     const element = document.createElement(\"a\");\r\n  //     const batText = `sshpass -praspberry scp -o StrictHostKeyChecking=no ./model.tflite pi@${props.ipAddress}:/home/pi/tflite/model.tflite\r\n  // sshpass -praspberry scp -o StrictHostKeyChecking=no ./labels.txt pi@${props.ipAddress}:/home/pi/tflite/labels.txt\r\n  // sshpass -praspberry scp -o StrictHostKeyChecking=no ./pibox.py pi@${props.ipAddress}:/home/pi/tflite/pibox.py\r\n  // `;\r\n  //     const file = new Blob([batText], {\r\n  //       type: \"text/plain\",\r\n  //     });\r\n  //     element.href = URL.createObjectURL(file);\r\n  //     element.download = os === \"WIN\" ? \"upload.bat\" : \"upload.sh\";\r\n  //     document.body.appendChild(element); // Required for this to work in FireFox\r\n  //     element.click();\r\n  //   }\r\n\r\n  const sendMoving = (index) => {\r\n    if (ch1OutputType === 2 || ch2OutputType === 2) {\r\n      alert(\"지금은 서보모터와 LED만 동작해 볼 수 있습니다!\");\r\n    } else {\r\n      if (checkTime + 1300 < Date.now()) {\r\n        const url = \"http://\" + props.ipAddress + \":8000/move.html?\";\r\n        let ch1Command = \"None\";\r\n        if ((!isNaN(parseFloat(ch1OutputAmount[index])) && ch1OutputType == 1) || (!isNaN(parseFloat(ch1OutputAmount[index].r)) && ch1OutputType == 3)) {\r\n          switch (ch1OutputType) {\r\n            case 1:\r\n              ch1Command = \"servo_\" + ch1OutputAmount[index];\r\n              break;\r\n            case 3:\r\n              ch1Command = \"led_\" + ch1OutputAmount[index].r + \"_\" + ch1OutputAmount[index].g + \"_\" + ch1OutputAmount[index].b;\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n        let ch2Command = \"None\";\r\n        if ((!isNaN(parseFloat(ch2OutputAmount[index])) && ch2OutputType == 1) || (!isNaN(parseFloat(ch2OutputAmount[index].r)) && ch2OutputType == 3)) {\r\n          switch (ch2OutputType) {\r\n            case 1:\r\n              ch2Command = \"servo_\" + ch2OutputAmount[index];\r\n              break;\r\n            case 3:\r\n              ch2Command = \"led_\" + ch2OutputAmount[index].r + \"_\" + ch2OutputAmount[index].g + \"_\" + ch2OutputAmount[index].b;\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n        //console.log(ch2OutputType, ch2OutputAmount);\r\n        //console.log(url + \"ch1=\" + ch1Command + \"&ch2=\" + ch2Command);\r\n        fetch(url + \"ch1=\" + ch1Command + \"&ch2=\" + ch2Command);\r\n        setCheckTime(Date.now());\r\n      }\r\n    }\r\n  };\r\n\r\n  useInterval(() => {\r\n    if (checkMove) {\r\n      if (ch1OutputType === 2 || ch2OutputType === 2) {\r\n        alert(\"지금은 서보모터와 LED만 동작할 수 있습니다!\");\r\n        setCheckMove(false);\r\n      } else {\r\n        if (moveMotorThreshold <= tfFunc.resultConfidence && tfFunc.result !== -1) {\r\n          sendMoving(tfFunc.result);\r\n        }\r\n      }\r\n    }\r\n  }, 100);\r\n\r\n  const selectOutputMount = (index) => (\r\n    <div className=\"showOutputType\" key={index}>\r\n      <span>\r\n        <div className=\"class-object-label\" style={{ marginTop: \"9px\", marginBottom: \"10px\" }}>\r\n          Output 1\r\n        </div>\r\n        {ch1OutputType === 1 ? (\r\n          <div className=\"servomotor\">\r\n            <p>\r\n              모터의 날개가 움직이는 각도를 설정해주세요.\r\n              <br /> ( 0 ~ 180 )\r\n            </p>\r\n            <input\r\n              style={{ height: 30 }}\r\n              onChange={(e) => {\r\n                let value = e.target.value;\r\n                setCh1OutputAmount((state) => {\r\n                  const newState = [...state];\r\n                  newState[index] = value > 180 ? 180 : value < 0 ? 0 : value;\r\n                  return newState;\r\n                });\r\n              }}\r\n              type=\"number\"\r\n              value={ch1OutputAmount[index] || \"\"}\r\n            />\r\n          </div>\r\n        ) : ch1OutputType === 2 ? (\r\n          <div style={{ display: \"inline\" }}>\r\n            <select\r\n              style={{\r\n                backgroundColor: \"#ffffff\",\r\n                fontSize: 15,\r\n                borderRadius: 2,\r\n              }}\r\n              onChange={(e) => {\r\n                const value = e.target.value;\r\n                setCh1OutputAmount((state) => {\r\n                  const newState = [...state];\r\n                  newState[index] = [value, newState[index][1], newState[index][2]];\r\n                  return newState;\r\n                });\r\n              }}\r\n              defaultValue={ch1OutputAmount[index][0]}\r\n            >\r\n              <option value=\"0\">정방향</option>\r\n              <option value=\"1\">역방향</option>\r\n            </select>\r\n            <div style={{ display: \"flex\" }}>\r\n              <div>\r\n                <h5 style={{ textAlign: \"center\" }}>속도 ( 0 ~ 100 ) </h5>\r\n                <input\r\n                  style={{ height: 30 }}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setCh1OutputAmount((state) => {\r\n                      const newState = [...state];\r\n                      newState[index] = [newState[index][0], value, newState[index][2]];\r\n                      return newState;\r\n                    });\r\n                  }}\r\n                  type=\"number\"\r\n                  value={ch1OutputAmount[index][1]}\r\n                />\r\n              </div>\r\n              <div style={{ marginLeft: \"10%\" }}>\r\n                <h5 style={{ textAlign: \"center\" }}>시간 ( 1 {\"=>\"} 1초 ) </h5>\r\n                <input\r\n                  style={{ height: 30 }}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setCh1OutputAmount((state) => {\r\n                      const newState = [...state];\r\n                      newState[index] = [newState[index][0], newState[index][1], value];\r\n                      return newState;\r\n                    });\r\n                  }}\r\n                  type=\"number\"\r\n                  value={ch1OutputAmount[index][2]}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : ch1OutputType === 3 ? (\r\n          <div style={{ display: \"inline\" }}>\r\n            <SliderPicker\r\n              color={ch1OutputAmount[index]}\r\n              onChange={(value) => {\r\n                setCh1OutputAmount((state) => {\r\n                  const newState = [...state];\r\n                  newState[index] = value.rgb;\r\n                  return newState;\r\n                });\r\n              }}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div style={{ padding: \"10px\" }}>출력 종류를 먼저 선택하세요</div>\r\n        )}\r\n      </span>\r\n      <span>\r\n        <div className=\"class-object-label\" style={{ marginTop: \"9px\", marginBottom: \"10px\" }}>\r\n          Output 2\r\n        </div>\r\n        {ch2OutputType === 1 ? (\r\n          <div className=\"servomotor\">\r\n            <p>\r\n              모터의 날개가 움직이는 각도를 설정해주세요.\r\n              <br />( 0 ~ 180 )\r\n            </p>\r\n            <input\r\n              style={{ height: 30 }}\r\n              onChange={(e) => {\r\n                let value = e.target.value;\r\n                setCh2OutputAmount((state) => {\r\n                  const newState = [...state];\r\n\r\n                  newState[index] = value > 180 ? 180 : value < 0 ? 0 : value;\r\n                  return newState;\r\n                });\r\n              }}\r\n              type=\"number\"\r\n              value={ch2OutputAmount[index] || \"\"}\r\n            />\r\n          </div>\r\n        ) : ch2OutputType === 2 ? (\r\n          <div style={{ display: \"inline\" }}>\r\n            <select\r\n              style={{\r\n                backgroundColor: \"#ffffff\",\r\n                fontSize: 15,\r\n                borderRadius: 2,\r\n              }}\r\n              onChange={(e) => {\r\n                const value = e.target.value;\r\n                setCh2OutputAmount((state) => {\r\n                  const newState = [...state];\r\n                  newState[index] = [value, newState[index][1], newState[index][2]];\r\n                  return newState;\r\n                });\r\n              }}\r\n              defaultValue={ch2OutputAmount[index][0]}\r\n            >\r\n              <option value=\"0\">정방향</option>\r\n              <option value=\"1\">역방향</option>\r\n            </select>\r\n            <div style={{ display: \"flex\" }}>\r\n              <div>\r\n                <h5 style={{ textAlign: \"center\" }}>속도 ( 0 ~ 100 ) </h5>\r\n                <input\r\n                  style={{ height: 30 }}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setCh2OutputAmount((state) => {\r\n                      const newState = [...state];\r\n                      newState[index] = [newState[index][0], value, newState[index][2]];\r\n                      return newState;\r\n                    });\r\n                  }}\r\n                  type=\"number\"\r\n                  value={ch2OutputAmount[index][1]}\r\n                />\r\n              </div>\r\n              <div style={{ marginLeft: \"10%\" }}>\r\n                <h5 style={{ textAlign: \"center\" }}>시간 ( 1 {\"=>\"} 1초 ) </h5>\r\n                <input\r\n                  style={{ height: 30 }}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setCh2OutputAmount((state) => {\r\n                      const newState = [...state];\r\n                      newState[index] = [newState[index][0], newState[index][1], value];\r\n                      return newState;\r\n                    });\r\n                  }}\r\n                  type=\"number\"\r\n                  value={ch2OutputAmount[index][2]}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : ch2OutputType === 3 ? (\r\n          <div style={{ display: \"inline\" }}>\r\n            <SliderPicker\r\n              color={ch2OutputAmount[index]}\r\n              onChangeComplete={(value) => {\r\n                setCh2OutputAmount((state) => {\r\n                  const newState = [...state];\r\n                  newState[index] = value.rgb;\r\n                  return newState;\r\n                });\r\n              }}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div style={{ padding: \"10px\" }}>출력 종류를 먼저 선택하세요</div>\r\n        )}\r\n      </span>\r\n      <span>\r\n        <button className=\"test-move\" onClick={() => sendMoving(index)}>\r\n          테스트하기\r\n        </button>\r\n      </span>\r\n    </div>\r\n  );\r\n\r\n  const selectOutputType = () => (\r\n    <div className=\"blocks\" style={{ display: \"inline\", width: \"49%\", marginLeft: \"1%\" }}>\r\n      <div className=\"block\" id=\"output-type-block\">\r\n        <div className=\"output-type\">\r\n          <div className=\"Out-put-01\">Output 01</div>\r\n          <div className=\"output-circles\">\r\n            <div\r\n              style={{ marginLeft: \"12%\" }}\r\n              onClick={() => {\r\n                if (ch1OutputType === 1) {\r\n                  setCh1OutputType(0);\r\n                  setCh1OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"\");\r\n                  });\r\n                } else {\r\n                  setCh1OutputType(1);\r\n                  setCh1OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"0\");\r\n                  });\r\n                }\r\n              }}\r\n            >\r\n              <img src={ch1OutputType === 1 ? \"img/servomotor_picked.svg\" : \"img/servomotor.svg\"} alt=\"servomotor\" style={{ cursor: \"pointer\" }} />\r\n            </div>\r\n\r\n            <div\r\n              style={{ marginLeft: \"40px\", marginRight: \"40px\" }}\r\n              onClick={() => {\r\n                if (ch1OutputType === 2) {\r\n                  setCh1OutputType(0);\r\n                  setCh1OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"\");\r\n                  });\r\n                } else {\r\n                  setCh1OutputType(2);\r\n                  setCh1OutputAmount((state) => {\r\n                    return new Array(state.length).fill([\"0\", \"50\", \"0.5\"]);\r\n                  });\r\n                }\r\n              }}\r\n            >\r\n              <img style={{ cursor: \"pointer\" }} src={ch1OutputType === 2 ? \"img/dcmotor_picked.svg\" : \"img/dcmotor.svg\"} alt=\"dcmotor\" />\r\n            </div>\r\n\r\n            <div\r\n              style={{ marginRight: \"12%\" }}\r\n              onClick={() => {\r\n                if (ch1OutputType === 3) {\r\n                  setCh1OutputType(0);\r\n                  setCh1OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"\");\r\n                  });\r\n                } else {\r\n                  if (ch2OutputType !== 3) {\r\n                    setCh1OutputType(3);\r\n                    setCh1OutputAmount((state) => {\r\n                      return new Array(state.length).fill({\r\n                        r: 255,\r\n                        g: 255,\r\n                        b: 255,\r\n                        a: 1,\r\n                      });\r\n                    });\r\n                  } else {\r\n                    alert(\"LED 출력은 1개의 채널만 가능합니다.\");\r\n                  }\r\n                }\r\n              }}\r\n            >\r\n              <img style={{ cursor: \"pointer\" }} src={ch1OutputType === 3 ? \"img/led_picked.svg\" : \"img/led.svg\"} alt=\"led\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"output-type\" style={{ marginLeft: \"80px\" }}>\r\n          <div className=\"Out-put-01\">Output 02</div>\r\n          <div className=\"output-circles\">\r\n            <div\r\n              style={{ marginLeft: \"12%\" }}\r\n              onClick={() => {\r\n                if (ch2OutputType === 1) {\r\n                  setCh2OutputType(0);\r\n                  setCh2OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"\");\r\n                  });\r\n                } else {\r\n                  setCh2OutputType(1);\r\n                  setCh2OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"0\");\r\n                  });\r\n                }\r\n              }}\r\n            >\r\n              <img style={{ cursor: \"pointer\" }} src={ch2OutputType === 1 ? \"img/servomotor_picked.svg\" : \"img/servomotor.svg\"} alt=\"servomotor\" />\r\n            </div>\r\n\r\n            <div\r\n              style={{ marginLeft: \"40px\", marginRight: \"40px\" }}\r\n              onClick={() => {\r\n                if (ch2OutputType === 2) {\r\n                  setCh2OutputType(0);\r\n                  setCh2OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"\");\r\n                  });\r\n                } else {\r\n                  setCh2OutputType(2);\r\n                  setCh2OutputAmount((state) => {\r\n                    return new Array(state.length).fill([\"0\", \"50\", \"0.5\"]);\r\n                  });\r\n                }\r\n              }}\r\n            >\r\n              <img style={{ cursor: \"pointer\" }} src={ch2OutputType === 2 ? \"img/dcmotor_picked.svg\" : \"img/dcmotor.svg\"} alt=\"dcmotor\" />\r\n            </div>\r\n\r\n            <div\r\n              style={{ marginRight: \"12%\" }}\r\n              onClick={() => {\r\n                if (ch2OutputType === 3) {\r\n                  setCh2OutputType(0);\r\n                  setCh2OutputAmount((state) => {\r\n                    return new Array(state.length).fill(\"\");\r\n                  });\r\n                } else {\r\n                  if (ch1OutputType !== 3) {\r\n                    setCh2OutputType(3);\r\n                    setCh2OutputAmount((state) => {\r\n                      return new Array(state.length).fill({\r\n                        r: 255,\r\n                        g: 255,\r\n                        b: 255,\r\n                        a: 1,\r\n                      });\r\n                    });\r\n                  } else {\r\n                    alert(\"LED 출력은 1개의 채널만 가능합니다.\");\r\n                  }\r\n                }\r\n              }}\r\n            >\r\n              <img style={{ cursor: \"pointer\" }} src={ch2OutputType === 3 ? \"img/led_picked.svg\" : \"img/led.svg\"} alt=\"dcmotor\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const cameraPreviewWithButtons = () => (\r\n    //아웃풋 종류 보여줌\r\n    <div style={{ position: \"fixed\" }}>\r\n      <div className=\"block-2\">\r\n        <div className=\"block\" ref={camera}></div>\r\n        <div style={{ marginLeft: \"20px\" }}>\r\n          <img src=\"img/plai_train.svg\" id=\"trainButton\" onClick={() => tfFunc.train()} className=\"plai-train\" />\r\n        </div>\r\n        <div style={{ marginLeft: \"20px\" }}>\r\n          <img style={{ cursor: \"pointer\" }} src={checkMove ? \"img/plai_move_on.svg\" : \"img/plai_move_off.svg\"} onClick={() => setCheckMove(!checkMove)} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"connect-panel panel\">\r\n      <img onClick={() => props.setIsBlockCoding()} src=\"img/icon_arrow_back.svg\" className=\"Icon-arrow_back-blockcode\"></img>\r\n      {false ? (\r\n        <div>\r\n          <p>\r\n            라벨 : <input type=\"file\" accept=\".txt\" onChange={(e) => uploadFile(e.target.files[0])} />\r\n          </p>\r\n        </div>\r\n      ) : null}\r\n      <div className=\"training-label\">학습하기</div>\r\n      <div style={{ display: \"flex\" }}>\r\n        <div style={{ width: \"32.3%\", marginLeft: \"8%\" }}>{cameraPreviewWithButtons()}</div>\r\n        <div style={{ width: \"67.7%\", marginRight: \"8%\" }}>\r\n          <div>{selectOutputType()}</div>\r\n          <div className=\"label-output\">\r\n            <div className=\"blocks-container\">\r\n              <div>\r\n                {labels.map((label, index) => (\r\n                  <div key={label}>\r\n                    <div className=\"class-object\">\r\n                      <div className=\"class-object-left\">\r\n                        <div className=\"block\">\r\n                          <span className=\"class-object-label\">{label}</span>\r\n                          <ProgressBar bgcolor={\"#00695c\"} completed={Math.floor(probability[index] * 100)} />\r\n                        </div>\r\n                        <div style={{ display: \"flex\" }}>\r\n                          <div\r\n                            style={{\r\n                              marginLeft: \"10px\",\r\n                              marginRight: \"10px\",\r\n                              position: \"relative\",\r\n                              top: \"123px\",\r\n                            }}\r\n                          >\r\n                            <img\r\n                              src=\"img/icon_video.svg\"\r\n                              className=\"Icon-awesome-video\"\r\n                              onMouseDown={() => {\r\n                                tfFunc.addTrainingData(index);\r\n                              }}\r\n                              onMouseUp={() => {\r\n                                tfFunc.addTrainingData(-1);\r\n                              }}\r\n                              onMouseLeave={() => {\r\n                                tfFunc.addTrainingData(-1);\r\n                              }}\r\n                            ></img>\r\n                          </div>\r\n                          <div className=\"training-images\" id={\"canvas-\" + index.toString()}></div>\r\n                        </div>\r\n                      </div>\r\n                      <hr size=\"2\" width=\"60px\" noshade=\"true\" className=\"class-object-connecting\"></hr>\r\n                      <div className=\"class-object-right\">\r\n                        <span className=\"class-output-settings\">{selectOutputMount(index)}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"block\" style={{ textAlign: \"center\" }}>\r\n        <img style={{ margin: \"0px auto\", marginTop: \"30px\", cursor: \"pointer\" }} onClick={() => addClass()} src=\"img/add_class.svg\"></img>\r\n      </div>\r\n      <div className=\"block\">\r\n        <img\r\n          style={{ margin: \"0px auto\", marginTop: \"30px\", cursor: \"pointer\" }}\r\n          onClick={() => (piboxUploadBtnName !== \"잠시만 기다려주세요...\" ? downloadPy() : null)}\r\n          src={piboxUploadBtnName === \"잠시만 기다려주세요...\" ? \"img/blockcode_uploading_button.svg\" : \"img/blockcode_upload_button.svg\"}\r\n        ></img>\r\n      </div>\r\n      {/* <div>\r\n        <h4>\r\n          블록이 완성되었다면{\" \"}\r\n          <span style={{ color: \"blue\", cursor: \"pointer\" }} onClick={() => downloadPy()}>\r\n            코드 다운로드\r\n          </span>{\" \"}\r\n        </h4>\r\n      </div> */}\r\n      {/* <div>\r\n        <h4>\r\n          <span style={{ color: \"blue\", cursor: \"pointer\" }} onClick={() => downloadBat(\"WIN\")}>\r\n            코드 업로드 프로그램(윈도우)\r\n          </span>\r\n          <br />\r\n          코드와 업로드 프로그램 파일은 모델파일을 압축푼 폴더와 같은 폴더에 넣어주세요.\r\n        </h4>\r\n        <p>\r\n          초기 비밀번호 : raspberry\r\n          <br />\r\n        </p>\r\n      </div> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction useInterval(callback, delay) {\r\n  const savedCallback = useRef();\r\n\r\n  // Remember the latest callback.\r\n  useEffect(() => {\r\n    savedCallback.current = callback;\r\n  }, [callback]);\r\n\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    function tick() {\r\n      savedCallback.current();\r\n    }\r\n    if (delay !== null) {\r\n      let id = setInterval(tick, delay);\r\n      return () => clearInterval(id);\r\n    }\r\n  }, [delay]);\r\n}\r\n","export const front = `\r\n## pibox TFLITE\r\nimport os\r\nimport argparse\r\nimport cv2\r\nimport numpy as np\r\nimport sys\r\nimport time\r\nfrom threading import Thread\r\nimport importlib.util\r\n\r\n## 출력을 위한 import\r\nimport RPi.GPIO as GPIO\r\nimport pigpio\r\nimport time\r\nimport board\r\nimport neopixel\r\n\r\n`;\r\n\r\nexport const middle = `\r\n# 카메라 오브젝트\r\nclass VideoStream:\r\n    def __init__(self,resolution=(320,240),framerate=3): # 원래는 640,480 그리고 30 framerate\r\n        # 파이 카메라를 시작합니다.\r\n        self.stream = cv2.VideoCapture(0)\r\n        ret = self.stream.set(cv2.CAP_PROP_FOURCC, cv2.VideoWriter_fourcc(*'MJPG'))\r\n        ret = self.stream.set(3,resolution[0])\r\n        ret = self.stream.set(4,resolution[1])\r\n            \r\n        # 첫번째 사진을 불러옵니다.\r\n        (self.grabbed, self.frame) = self.stream.read()\r\n\r\n\t    # 멈출 수 있도록 stopped를 설정해줍니다.\r\n        self.stopped = False\r\n\r\n    def start(self):\r\n\t    # 비디오 스트림에서 프레임을 읽어오는 쓰레드를 시작합니다.\r\n        Thread(target=self.update,args=()).start()\r\n        return self\r\n\r\n    def update(self):\r\n        # 쓰레드가 멈출 때 까지 계속 스트림을 실행합니다.\r\n        while True:\r\n            # 카메라가 멈추면 스트림을 멈춥니다.\r\n            if self.stopped:\r\n                # 카메라 리소스를 닫습니다.\r\n                self.stream.release()\r\n                return\r\n\r\n            # 멈춘것이 아니라면 프레임을 가져옵니다.\r\n            (self.grabbed, self.frame) = self.stream.read()\r\n\r\n    def read(self):\r\n\t    # 가장 최근 프레임을 가져옵니다.\r\n        return self.frame\r\n\r\n    def stop(self):\r\n\t    # 카메라 쓰레드를 정지합니다.\r\n        self.stopped = True\r\n\r\n# 입력 파라미터를 정의합니다.\r\nparser = argparse.ArgumentParser()\r\nparser.add_argument('--modeldir', help='Folder the .tflite file is located in',\r\n                    required=True)\r\nparser.add_argument('--graph', help='Name of the .tflite file, if different than model.tflite',\r\n                    default='model.tflite')\r\nparser.add_argument('--labels', help='Name of the labelmap file, if different than labels.txt',\r\n                    default='labels.txt')\r\nparser.add_argument('--threshold', help='Minimum confidence threshold for displaying detected objects',\r\n                    default=0.5)\r\nparser.add_argument('--resolution', help='Desired webcam resolution in WxH. If the webcam does not support the resolution entered, errors may occur.',\r\n                    default='320x240') # 원래는 1280x720 속도를 위해 낮춤\r\nparser.add_argument('--edgetpu', help='Use Coral Edge TPU Accelerator to speed up detection',\r\n                    action='store_true',default=False)\r\n\r\nargs = parser.parse_args()\r\n\r\nMODEL_NAME = args.modeldir\r\nGRAPH_NAME = args.graph\r\nLABELMAP_NAME = args.labels\r\nmin_conf_threshold = float(args.threshold)\r\nresW, resH = args.resolution.split('x')\r\nimW, imH = int(resW), int(resH) # 라즈베리파이 제로 + 파이카메라에서는 224,224 가 아주 쬐에에에끔 빠릅니다.\r\nuse_TPU = args.edgetpu\r\n\r\n# 텐서플로우 라이브러리를 가져옵니다.\r\n# 텐서플로우 라이브러리가 없다면, tflite_runtime 을 가져옵니다.\r\n# 코랄 TPU를 사용한다면, TPU 용 라이브러리를 가져옵니다. (import the load_delegate library)\r\npkg = importlib.util.find_spec('tensorflow')\r\nif pkg is None:\r\n    from tflite_runtime.interpreter import Interpreter\r\n    if use_TPU:\r\n        from tflite_runtime.interpreter import load_delegate\r\nelse:\r\n    from tensorflow.lite.python.interpreter import Interpreter\r\n    if use_TPU:\r\n        from tensorflow.lite.python.interpreter import load_delegate\r\n\r\n# TPU를 사용한다면 TPU 모델을 가져옵니다.\r\nif use_TPU:\r\n    # 'edgetpu.tflite'가 TPU를 사용할 때의 기본 경로입니다.\r\n    if (GRAPH_NAME == 'model.tflite'):\r\n        GRAPH_NAME = 'edgetpu.tflite'       \r\n\r\n# 작업 경로와 현재 경로를 일치시킵니다.\r\nCWD_PATH = os.getcwd()\r\n\r\n# 모델 경로를 설정합니다.\r\nPATH_TO_CKPT = os.path.join(CWD_PATH,MODEL_NAME,GRAPH_NAME)\r\n\r\n# 라벨 경로를 설정합니다.\r\nPATH_TO_LABELS = os.path.join(CWD_PATH,MODEL_NAME,LABELMAP_NAME)\r\n\r\n# 라벨을 가져옵니다.\r\nwith open(PATH_TO_LABELS, 'r') as f:\r\n    labels = [line.strip() for line in f.readlines()]\r\n\r\n# 첫번째 라벨이 ??? 인 경우가 있어 그럴 경우 제거합니다.\r\nif labels[0] == '???':\r\n    del(labels[0])\r\n\r\n# 텐서플로우 모델을 가져옵니다. TPU를 쓸 경우 TPU 모델로 가져옵니다.\r\nif use_TPU:\r\n    interpreter = Interpreter(model_path=PATH_TO_CKPT,\r\n                              experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\r\n    print(PATH_TO_CKPT)\r\nelse:\r\n    interpreter = Interpreter(model_path=PATH_TO_CKPT)\r\n\r\ninterpreter.allocate_tensors()\r\n\r\n# 로드된 모델의 정보를 가져옵니다.\r\ninput_details = interpreter.get_input_details()\r\noutput_details = interpreter.get_output_details()\r\nheight = input_details[0]['shape'][1]\r\nwidth = input_details[0]['shape'][2]\r\n#print(\"가로\")\r\n#print(width)\r\n#print(\"세로\")\r\n#print(height)\r\n# 입력이 소수인지 아닌지 판단합니다.\r\nfloating_model = (input_details[0]['dtype'] == np.float32)\r\n\r\ninput_mean = 127.5\r\ninput_std = 127.5\r\n\r\n# 연산 프레임을 체크하기 위한 변수를 할당합니다.\r\nframe_rate_calc = 1\r\nfreq = cv2.getTickFrequency()\r\n\r\n# 상단에서 정의한 비디오 스트림을 시작합니다.\r\nvideostream = VideoStream(resolution=(imW,imH),framerate=30).start() \r\ntime.sleep(1)\r\n\r\n# 프레임으로 연산을 시작합니다.\r\nwhile True:\r\n\r\n    # 연산 프레임을 위한 시간 체크 변수를 할당합니다.\r\n    t1 = cv2.getTickCount()\r\n\r\n    # 비디오스트림에서 프레임을 읽어옵니다.\r\n    frame1 = videostream.read()\r\n\r\n    # 입력에 넣을 수 있도록 해상도를 변경합니다.\r\n    frame = frame1.copy()\r\n    frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\r\n    # 위에서 input을 224,224로 설정했다면 아래 줄은 넘어가도 됩니다..\r\n    frame_resized = cv2.resize(frame_rgb, (width, height)) \r\n    input_data = np.expand_dims(frame_resized, axis=0)\r\n\r\n    # 입력이 소수라면 소수로 바꿔줍니다.\r\n    if floating_model:\r\n        input_data = (np.float32(input_data) - input_mean) / input_std\r\n\r\n    # 로드된 모델에 입력을 넣어 결과를 가져옵니다.\r\n    interpreter.set_tensor(input_details[0]['index'],input_data)\r\n    interpreter.invoke()\r\n    result=interpreter.get_tensor(output_details[0]['index'])[0]\r\n    print(labels[np.argmax(result)])\r\n    #print(result)\r\n    # 초당 연산 프레임을 계산합니다.\r\n    t2 = cv2.getTickCount()\r\n    time1 = (t2-t1)/freq\r\n    frame_rate_calc= 1/time1\r\n    #print(frame_rate_calc)\r\n`;\r\n","import React from \"react\";\r\nimport Notifications, { notify } from \"react-notify-toast\";\r\nimport WifiSSH from \"./WifiSSH\";\r\nimport BlockCode from \"./BlockCode\";\r\nimport \"./App.css\";\r\nimport UUID from \"./uuid\";\r\n\r\nexport default class BluetoothConnect extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      supportBluetooth: Boolean(window.navigator.bluetooth),\r\n      isConnected: false,\r\n      serverId: \"\",\r\n      ssid: \"\",\r\n      password: \"\",\r\n      key: \"pibox\",\r\n      wifiLock: false,\r\n      characteristicsList: [],\r\n      infoList: [],\r\n      commandList: [],\r\n      isBlockCoding: false,\r\n      commandOutput: \"\",\r\n      commandOutputShouldRefresh: false,\r\n      loading: null,\r\n      charLength: -1,\r\n      customInfoCount: 0,\r\n      customCommandCount: 0,\r\n      wifiReset: false,\r\n      isAndroid: navigator.userAgent.indexOf(\"Android\") > -1 || navigator.userAgent.indexOf(\"Adr\") > -1,\r\n      isIphone: navigator.userAgent.indexOf(\"iPhone\") > -1 || navigator.userAgent.indexOf(\"iphone\") > -1,\r\n      wifiConnected: false,\r\n    };\r\n    for (let i in UUID) {\r\n      UUID[i] = UUID[i].toLowerCase();\r\n    }\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  connectDevice = () => {\r\n    navigator.bluetooth\r\n      .requestDevice({\r\n        filters: [\r\n          {\r\n            services: [UUID.SERVICE_ID],\r\n          },\r\n        ],\r\n      })\r\n      .then((device) => {\r\n        //GO loading screen\r\n        return device.gatt.connect();\r\n      })\r\n      .then((server) => {\r\n        this.setState({ serverId: server.device.id });\r\n        return server.getPrimaryService(UUID.SERVICE_ID);\r\n      })\r\n      .then((service) => {\r\n        if (this.state.isIphone) {\r\n          // iOS webBLE does not support getCharacteristics()\r\n          console.log(\"ios webBLE\");\r\n          return this.webBleConnect(service);\r\n        } else {\r\n          return service.getCharacteristics();\r\n        }\r\n      })\r\n      .then(async (characteristics) => {\r\n        console.log(\"Connected!\");\r\n        let characteristicsList = characteristics;\r\n        this.setState({ isConnected: true });\r\n        let infoList = [\r\n          {\r\n            preset: true,\r\n            uuid: \"\",\r\n            label: \"Device ID\",\r\n            value: this.state.serverId,\r\n          },\r\n          {\r\n            preset: true,\r\n            uuid: UUID.DEVICE_MODEL,\r\n            label: \"Model\",\r\n            value: \" \",\r\n          },\r\n          {\r\n            preset: true,\r\n            uuid: UUID.WIFI_NAME,\r\n            label: \"Wifi\",\r\n            value: \"...\",\r\n          },\r\n          {\r\n            preset: true,\r\n            uuid: UUID.IP_ADDRESS,\r\n            label: \"IP Address\",\r\n            value: \"...\",\r\n          },\r\n        ];\r\n\r\n        await this.subscribeCharacteristic(UUID.WIFI_NAME, infoList, characteristicsList);\r\n        await this.subscribeCharacteristic(UUID.IP_ADDRESS, infoList, characteristicsList);\r\n        await this.readInfoCharacteristic(UUID.DEVICE_MODEL, infoList, characteristicsList);\r\n        await this.subscribeCharacteristic(UUID.NOTIFY_MESSAGE, infoList, characteristicsList);\r\n        await this.subscribeCharacteristic(UUID.CUSTOM_COMMAND_NOTIFY, infoList, characteristicsList);\r\n\r\n        characteristicsList\r\n          .filter((i) => i.uuid.indexOf(UUID.CUSTOM_INFO_LABEL) >= 0)\r\n          .map((item) =>\r\n            infoList.push({\r\n              uuid: item.uuid.replace(UUID.CUSTOM_INFO_LABEL, UUID.CUSTOM_INFO),\r\n              uuid_label: item.uuid,\r\n              label: \"-\",\r\n              value: \"\",\r\n            })\r\n          );\r\n        for (let i = 0; i < infoList.length; i++) {\r\n          if (infoList[i].preset) continue;\r\n          await this.readInfoCharacteristic(infoList[i].uuid_label, infoList, characteristicsList);\r\n          await this.subscribeCharacteristic(infoList[i].uuid, infoList, characteristicsList);\r\n        }\r\n        let tempCharList = [];\r\n        characteristicsList\r\n          .filter((i) => i.uuid.indexOf(UUID.CUSTOM_COMMAND_LABEL) >= 0)\r\n          .map((item) =>\r\n            tempCharList.push({\r\n              uuid: item.uuid,\r\n              label: \"...\",\r\n            })\r\n          );\r\n        let commandList = tempCharList;\r\n        for (let i = 0; i < commandList.length; i++) {\r\n          await this.readCommandLabel(commandList[i].uuid, commandList, characteristicsList);\r\n        }\r\n        this.setState({\r\n          characteristicsList: characteristicsList,\r\n          infoList: infoList,\r\n          commandList: commandList,\r\n        });\r\n        //console.log(commandList);\r\n        // 0: {uuid: \"00000000-0000-0000-0000-fd2bcccc0001\", label: \"shutdown\"}\r\n        // 1: {uuid: \"00000000-0000-0000-0000-fd2bcccc0002\", label: \"reboot\"}\r\n        // 2: {uuid: \"00000000-0000-0000-0000-fd2bcccc0003\", label: \"start\"}\r\n        // 3: {uuid: \"00000000-0000-0000-0000-fd2bcccc0004\", label: \"stop\"}\r\n        // 4: {uuid: \"00000000-0000-0000-0000-fd2bcccc0005\", label: \"upload\"}\r\n        // 5: {uuid: \"00000000-0000-0000-0000-fd2bcccc0006\", label: \"camStart\"}\r\n\r\n        // loading close\r\n      })\r\n      .catch(console.log);\r\n  };\r\n\r\n  readCommandLabel = (uuid, commandList, characteristicsList) => {\r\n    //console.log(\"readCommandLabel\");\r\n    return new Promise((resolve) => {\r\n      this.getCharacteristicInit(uuid, characteristicsList)\r\n        .readValue()\r\n        .then((i) => i.buffer)\r\n        .then(this.ab2str)\r\n        .then((label) => {\r\n          let tempCMDList = commandList;\r\n          tempCMDList.find((i) => i.uuid === uuid).label = label;\r\n          this.setState({ commandList: tempCMDList }, resolve());\r\n        });\r\n    });\r\n  };\r\n\r\n  readInfoCharacteristic = (uuid, infoList, characteristicsList) => {\r\n    //console.log(\"readInfoCharacteristic\");\r\n    return new Promise((resolve) => {\r\n      this.getCharacteristicInit(uuid, characteristicsList)\r\n        .readValue()\r\n        .then((i) => i.buffer)\r\n        .then(this.ab2str)\r\n        .then((value) => {\r\n          const tempInfoList = infoList;\r\n          if (tempInfoList.find((i) => i.uuid === uuid)) {\r\n            tempInfoList.find((i) => i.uuid === uuid).value = value;\r\n          }\r\n          if (tempInfoList.find((i) => i.uuid_label === uuid)) {\r\n            tempInfoList.find((i) => i.uuid_label === uuid).label = value;\r\n          }\r\n          if (tempInfoList !== this.state.infoList) this.setState({ infoList: tempInfoList }, resolve());\r\n          else resolve();\r\n        });\r\n    });\r\n  };\r\n\r\n  subscribeCharacteristic = (uuid, infoList, characteristicsList) => {\r\n    //console.log(\"subscribeCharacteristic\");\r\n    return new Promise(async (resolve) => {\r\n      this.getCharacteristicInit(uuid, characteristicsList).addEventListener(\"characteristicvaluechanged\", (event) => {\r\n        if (event.target.uuid === UUID.NOTIFY_MESSAGE) {\r\n          let msg = this.ab2str(event.target.value.buffer);\r\n          notify.show(msg, \"custom\", 3000, \"teal\");\r\n        } else if (event.target.uuid === UUID.CUSTOM_COMMAND_NOTIFY) {\r\n          let msg = this.ab2str(event.target.value.buffer);\r\n          if (this.state.commandOutputShouldRefresh) {\r\n            this.setState({ commandOutputShouldRefresh: false, commandOutput: \"\" }, () => {\r\n              let output = this.state.commandOutput + msg;\r\n              if (output.endsWith(\"&#&\")) {\r\n                output = output.replace(\"&#&\", \"\");\r\n                this.setState({ commandOutputShouldRefresh: true });\r\n              }\r\n              this.setState({ commandOutput: output });\r\n            });\r\n          } else {\r\n            let output = this.state.commandOutput + msg;\r\n            if (output.endsWith(\"&#&\")) {\r\n              output = output.replace(\"&#&\", \"\");\r\n              this.setState({ commandOutputShouldRefresh: true });\r\n            }\r\n            this.setState({ commandOutput: output });\r\n          }\r\n        } else {\r\n          let value = this.ab2str(event.target.value.buffer);\r\n          let tempInfoList = infoList;\r\n          if (tempInfoList.find((i) => i.uuid === uuid)) {\r\n            tempInfoList.find((i) => i.uuid === uuid).value = value;\r\n          }\r\n          if (tempInfoList.find((i) => i.uuid_label === uuid)) {\r\n            tempInfoList.find((i) => i.uuid_label === uuid).label = value;\r\n          }\r\n          this.setState({ infoList: tempInfoList });\r\n        }\r\n      });\r\n      await this.getCharacteristicInit(uuid, characteristicsList).startNotifications();\r\n      resolve();\r\n    });\r\n  };\r\n\r\n  webBleConnect = (service) => {\r\n    return new Promise(async (resolve) => {\r\n      await service\r\n        .getCharacteristic(UUID.PREFIX + UUID.CUSTOM_INFO_COUNT)\r\n        .then((characteristic) => characteristic.readValue())\r\n        .then((i) => i.buffer)\r\n        .then(this.ab2str)\r\n        .then(parseInt)\r\n        .then((value) => {\r\n          console.log(\"custom-info-count \" + value);\r\n          this.setState({ customInfoCount: value });\r\n        });\r\n      await service\r\n        .getCharacteristic(UUID.PREFIX + UUID.CUSTOM_COMMAND_COUNT)\r\n        .then((characteristic) => characteristic.readValue())\r\n        .then((i) => i.buffer)\r\n        .then(this.ab2str)\r\n        .then(parseInt)\r\n        .then((value) => {\r\n          console.log(\"custom-command-count \" + value);\r\n          this.setState({ customCommandCount: value }, () => {\r\n            let customInfoList = [];\r\n            for (let index = 0; index < this.state.customInfoCount; index++) {\r\n              let ending = (index + 1).toString(16);\r\n              ending = \"0\".repeat(4 - ending.length) + ending;\r\n              customInfoList.push(UUID.PREFIX + UUID.CUSTOM_INFO + ending);\r\n              customInfoList.push(UUID.PREFIX + UUID.CUSTOM_INFO_LABEL + ending);\r\n            }\r\n            let customCommandList = [];\r\n            for (let index = 0; index < this.state.customCommandCount; index++) {\r\n              let ending = (index + 1).toString(16);\r\n              ending = \"0\".repeat(4 - ending.length) + ending;\r\n              customCommandList.push(UUID.PREFIX + UUID.CUSTOM_COMMAND_LABEL + ending);\r\n            }\r\n            resolve(\r\n              Promise.all([\r\n                service.getCharacteristic(UUID.SERVICE_NAME),\r\n                service.getCharacteristic(UUID.DEVICE_MODEL),\r\n                service.getCharacteristic(UUID.WIFI_NAME),\r\n                service.getCharacteristic(UUID.IP_ADDRESS),\r\n                service.getCharacteristic(UUID.NOTIFY_MESSAGE),\r\n                service.getCharacteristic(UUID.INPUT_SEP),\r\n                service.getCharacteristic(UUID.CUSTOM_COMMAND_INPUT),\r\n                service.getCharacteristic(UUID.CUSTOM_COMMAND_NOTIFY),\r\n                ...customInfoList.map((i) => service.getCharacteristic(i)),\r\n                ...customCommandList.map((i) => service.getCharacteristic(i)),\r\n              ])\r\n            );\r\n          });\r\n        });\r\n    });\r\n  };\r\n  ab2str = (buf) => {\r\n    return String.fromCharCode.apply(null, new Uint8Array(buf));\r\n  };\r\n\r\n  getCharacteristic = (uuid) => {\r\n    return this.state.characteristicsList.find((i) => i.uuid === uuid);\r\n  };\r\n\r\n  getCharacteristicInit = (uuid, characteristicsList) => {\r\n    return characteristicsList.find((i) => i.uuid === uuid);\r\n  };\r\n\r\n  inputWifi = () => {\r\n    this.setState(\r\n      {\r\n        key: this.state.key.trim().replace(/\\|/g, \"*\"),\r\n        ssid: this.state.ssid.trim().replace(/\\|/g, \"*\"),\r\n        password: this.state.password.trim().replace(/\\|/g, \"*\"),\r\n      },\r\n      () => {\r\n        let errMsg;\r\n        if (this.state.ssid === \"\") {\r\n          errMsg = \"SSID cannot be empty.\";\r\n        }\r\n        if (this.state.password === \"\") {\r\n          errMsg = \"Password cannot be empty.\";\r\n        }\r\n        if (errMsg) {\r\n          notify.show(errMsg, \"custom\", 3000, \"teal\");\r\n          return;\r\n        }\r\n        this.setState({ wifiLock: true }, () =>\r\n          setTimeout(() => {\r\n            this.setState({ wifiLock: false, wifiReset: false });\r\n          }, 4000)\r\n        );\r\n\r\n        let sendArray = this.str2abs(`${this.state.key}%&%${this.state.ssid}%&%${this.state.password}&#&`);\r\n        this.sendSeparately(sendArray, UUID.INPUT_SEP);\r\n      }\r\n    );\r\n  };\r\n  sendCommand = (uuid) => {\r\n    let sendArray = this.str2abs(`${this.state.key}%&%${uuid.slice(-4)}&#&`);\r\n    this.sendSeparately(sendArray, UUID.CUSTOM_COMMAND_INPUT);\r\n  };\r\n  sendSeparately = async (array, uuid) => {\r\n    for (const i in array) {\r\n      await this.getCharacteristic(uuid).writeValue(array[i]);\r\n      await this.wait(0.4);\r\n    }\r\n  };\r\n  wait = async (sec) => {\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        resolve(true);\r\n      }, 1000 * sec);\r\n    });\r\n  };\r\n  waitCamera = async () => {\r\n    let chk = true;\r\n    if (this.state.infoList.find((i) => i.label === \"IP Address\") !== undefined && this.state.infoList.find((i) => i.label === \"IP Address\").value !== \"\") {\r\n      while (chk) {\r\n        await fetch(\"http://\" + this.state.infoList.find((i) => i.label === \"IP Address\").value + \":8000/index.html\")\r\n          // eslint-disable-next-line\r\n          .then(async (resp) => {\r\n            if (!resp.ok) {\r\n              await this.wait(0.5);\r\n            } else {\r\n              chk = false;\r\n            }\r\n          })\r\n          .catch(async () => {\r\n            await this.wait(0.5);\r\n          });\r\n      }\r\n      return true;\r\n    } else {\r\n      alert(\"와이파이가 연결되어있지 않습니다.\");\r\n      return false;\r\n    }\r\n  };\r\n  str2abs = (str) => {\r\n    let val = \"\";\r\n    for (let i = 0; i < str.length; i++) {\r\n      if (val === \"\") {\r\n        val = str.charCodeAt(i).toString(16);\r\n      } else {\r\n        val += \",\" + str.charCodeAt(i).toString(16);\r\n      }\r\n    }\r\n    let valArray = val.split(\",\");\r\n    let bufferArray = [];\r\n    while (valArray.length > 0) {\r\n      let value = valArray.splice(0, 20).join(\",\");\r\n      bufferArray.push(\r\n        new Uint8Array(\r\n          value.match(/[\\da-f]{2}/gi).map(function (h) {\r\n            return parseInt(h, 16);\r\n          })\r\n        ).buffer\r\n      );\r\n    }\r\n    return bufferArray;\r\n  };\r\n\r\n  setIsBlockCodingToFalse = () => {\r\n    this.setState({ isBlockCoding: false });\r\n    this.sendCommand(this.state.commandList.find((c) => c.label === \"stop\").uuid);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"BluetoothConnect\">\r\n        <div id=\"app\">\r\n          <Notifications />\r\n          <img src=\"img/logo.svg\" className=\"logo\"></img>\r\n          <div className=\"panel-container\">\r\n            {!this.state.supportBluetooth ? (\r\n              <div className=\"connect-panel panel\">\r\n                <div className=\"panel-title\">Cannot find web bluetooth.</div>\r\n                <p>\r\n                  Please make sure your device and browser support web bluetooth. Please visit{\" \"}\r\n                  <a href=\"https://github.com/WebBluetoothCG/web-bluetooth/blob/master/implementation-status.md\" target=\"_brank\">\r\n                    Here\r\n                  </a>{\" \"}\r\n                  to check web-bluetooth compatibility.\r\n                </p>\r\n              </div>\r\n            ) : null}\r\n            {!this.state.isConnected && this.state.supportBluetooth ? (\r\n              <div className=\"connect-panel panel\">\r\n                <img src=\"img/icon_arrow_back.svg\" className=\"Icon-arrow_back\"></img>\r\n                <div className=\"character-button\">\r\n                  <img src=\"img/character.svg\" className=\"character\"></img>\r\n                  <div className=\"Look-it-up\">Look it up!</div>\r\n                  <div className=\"PLAi-Bluetooth-\">PLAi를 움직일 Bluetooth를 찾아볼까요?</div>\r\n                  <div onClick={this.connectDevice}>\r\n                    <img src=\"img/bluetooth_button.svg\" className=\"bluetooth_button\"></img>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n            {this.state.isConnected && false ? (\r\n              <div className=\"info-panel panel\">\r\n                <div className=\"panel-title\">기기 정보</div>\r\n                {this.state.infoList.map((item) => {\r\n                  if (item.label === \"Wifi\" || item.label === \"IP Address\" || item.label === \"CPU Temp\" || item.label === \"CPU Load\") {\r\n                    return (\r\n                      <div key={item.uuid} className=\"info-group\">\r\n                        <div className=\"label\">{item.label}</div>\r\n                        <div className=\"value\">{item.value}</div>\r\n                      </div>\r\n                    );\r\n                  } else {\r\n                    return null;\r\n                  }\r\n                })}\r\n              </div>\r\n            ) : null}\r\n            {(this.state.isConnected && (this.state.infoList.find((i) => i.label === \"IP Address\") === undefined || this.state.infoList.find((i) => i.label === \"IP Address\").value === \"\")) ||\r\n            this.state.wifiReset ? (\r\n              <div className=\"wifi-panel panel\">\r\n                <img src=\"img/icon_arrow_back.svg\" className=\"Icon-arrow_back\"></img>\r\n                <div className=\"WiFi-password-container\">\r\n                  <div className=\"wifi-setting-title\">\r\n                    <span className=\"WiFi-\">WiFi 설정</span>\r\n                    <img src=\"img/character2.svg\" className=\"character2\"></img>\r\n                  </div>\r\n                  <div className=\"wifi-name-container\">\r\n                    <div>\r\n                      <span className=\"Wifi-Name\">WiFi Name</span>\r\n                      <input className=\"wifi-name-input\" placeholder=\"  와이파이 이름(SSID)\" value={this.state.ssid} onChange={(value) => this.setState({ ssid: value.target.value })} />\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"Wifi-Password\">WiFi Password</span>\r\n                      <input\r\n                        className=\"wifi-password-input\"\r\n                        placeholder=\"  와이파이 비밀번호\"\r\n                        value={this.state.password}\r\n                        onChange={(value) =>\r\n                          this.setState({\r\n                            password: value.target.value.replace(/[ㄱ-ㅎㅏ-ㅣ가-힣]/g, \"\"),\r\n                          })\r\n                        }\r\n                        type=\"password\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  {/* <div>\r\n                    <input placeholder=\"Key (Default: pibox)\" value={this.state.key} onChange={(value) => this.setState({ key: value.target.value })} />\r\n                  </div> */}\r\n                  <div>\r\n                    <img className=\"wifi-button\" onClick={this.inputWifi} disabled={this.state.wifiLock} src={this.state.wifiLock ? \"img/wifing_button.svg\" : \"img/wifi_button.svg\"}></img>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n            {this.state.isConnected &&\r\n            this.state.infoList.find((i) => i.label === \"IP Address\") !== undefined &&\r\n            this.state.infoList.find((i) => i.label === \"IP Address\").value !== \"\" &&\r\n            !this.state.wifiConnected &&\r\n            !this.state.wifiReset ? (\r\n              <div className=\"connect-panel panel\">\r\n                <img src=\"img/icon_arrow_back.svg\" onClick={() => this.setState({ wifiReset: true })} className=\"Icon-arrow_back\"></img>\r\n                <div className=\"character-button\">\r\n                  <img src=\"img/character2.svg\" className=\"character\"></img>\r\n                  <div className=\"Look-it-up\">WiFi 설정이 완료 되었습니다.</div>\r\n                  <div className=\"PLAi-Bluetooth-\">PLAi와 함께 놀아볼까요?</div>\r\n                  <div onClick={() => this.setState({ wifiConnected: true })}>\r\n                    <img src=\"img/wifi_next.svg\" className=\"bluetooth_button\"></img>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n            {/* <div className=\"command-panel panel\">\r\n              <div className=\"panel-title\">커스텀 명령어</div>\r\n              {this.state.commandList.length > 0 ? (\r\n                <div>\r\n                  <div>\r\n                    {this.state.commandList.map((item) => (\r\n                      <div key={item.uuid} className=\"button-wrap\">\r\n                        <button size=\"small\" onClick={() => this.sendCommand(item.uuid)}>\r\n                          {item.label}\r\n                        </button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                  <div>\r\n                    <input placeholder=\"Key (Default: pibox)\" value={this.state.key} onChange={(value) => this.setState({ key: value.target.value })} />\r\n                  </div>\r\n                  <div>\r\n                    <input type=\"textarea\" placeholder=\"Output\" value={this.state.commandOutput} readOnly={true} rows=\"10\" />\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <p>커스텀 명령어가 없습니다.</p>\r\n              )}\r\n            </div> */}\r\n          </div>\r\n          {/* {this.state.isConnected && false ? (\r\n            <div className=\"panel-container\">\r\n              <WifiSSH ipAddress={this.state.infoList.find((i) => i.label === \"IP Address\") === undefined ? \"\" : this.state.infoList.find((i) => i.label === \"IP Address\").value} />\r\n            </div>\r\n          ) : null} */}\r\n\r\n          {this.state.isConnected && !this.state.isBlockCoding && this.state.wifiConnected && !this.state.wifiReset ? (\r\n            <div className=\"connect-panel panel\">\r\n              <img src=\"img/icon_arrow_back.svg\" onClick={() => this.setState({ wifiReset: true })} className=\"Icon-arrow_back\"></img>\r\n              <div className=\"character-button\">\r\n                <img src=\"img/plai_character.svg\" className=\"character\"></img>\r\n                {this.state.isConnected &&\r\n                this.state.infoList.find((i) => i.label === \"IP Address\") !== undefined &&\r\n                this.state.infoList.find((i) => i.label === \"IP Address\").value !== \"\" &&\r\n                this.state.infoList.find((i) => i.label === \"Machine ID\") !== undefined &&\r\n                this.state.infoList.find((i) => i.label === \"Machine ID\").value !== \"\" &&\r\n                !this.state.isBlockCoding &&\r\n                this.state.wifiConnected ? (\r\n                  <div\r\n                    onClick={async () => {\r\n                      this.sendCommand(this.state.commandList.find((c) => c.label === \"camStart\").uuid);\r\n                      await this.wait(2.0);\r\n                      await this.waitCamera();\r\n                      this.setState({ isBlockCoding: true });\r\n                    }}\r\n                  >\r\n                    <img src=\"img/start_blockcode_button.svg\" className=\"bluetooth_button\"></img>\r\n                  </div>\r\n                ) : (\r\n                  <div>\r\n                    <img src=\"img/start_blockcode_button_not_available.svg\" className=\"bluetooth_button\"></img>\r\n                  </div>\r\n                )}\r\n                <div\r\n                  onClick={async () => {\r\n                    this.sendCommand(this.state.commandList.find((c) => c.label === \"start\").uuid);\r\n                    await this.wait(0.5);\r\n                  }}\r\n                >\r\n                  <img src=\"img/start_plai_button.svg\" className=\"bluetooth_button\"></img>\r\n                </div>\r\n                <div\r\n                  onClick={async () => {\r\n                    this.sendCommand(this.state.commandList.find((c) => c.label === \"stop\").uuid);\r\n                    this.setState({ isBlockCoding: false });\r\n                    await this.wait(0.5);\r\n                  }}\r\n                >\r\n                  <img src=\"img/stop_plai_button.svg\" className=\"bluetooth_button\"></img>\r\n                </div>\r\n                <div\r\n                  onClick={async () => {\r\n                    this.sendCommand(this.state.commandList.find((c) => c.label === \"reboot\").uuid);\r\n                    await this.wait(0.5);\r\n                  }}\r\n                >\r\n                  <img src=\"img/plai_reboot_button.svg\" className=\"bluetooth_button\"></img>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n          {this.state.isConnected && this.state.isBlockCoding && this.state.wifiConnected && !this.state.wifiReset ? (\t\r\n            <div className=\"panel-container\">\t\r\n              <BlockCode\t\r\n                ipAddress={\t\r\n                  this.state.infoList.find((i) => i.label === \"IP Address\") === undefined\t\r\n                    ? \"\"\t\r\n                    : this.state.infoList.find((i) => i.label === \"IP Address\").value\t\r\n                }\t\r\n                machineId={\t\r\n                  this.state.infoList.find((i) => i.label === \"Machine ID\") === undefined\t\r\n                    ? \"\"\t\r\n                    : this.state.infoList.find((i) => i.label === \"Machine ID\").value\t\r\n                }\t\r\n                sendCommand={this.sendCommand}\t\r\n                uploadUUID={this.state.commandList.find((c) => c.label === \"upload\").uuid}\t\r\n                setIsBlockCoding={this.setIsBlockCodingToFalse}\t\r\n              />\t\r\n            </div>\t\r\n          ) : null}\r\n\r\n          <div className=\"copyright\">PiBox . Open source under GPL-3.0 license.</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport \"./App.css\";\r\nimport BluetoothConnect from \"./BluetoothConnect\";\r\n\r\nfunction App() {\r\n  return <BluetoothConnect />;\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\") || document.createElement(\"div\"));\r\n","module.exports = {\r\n  PREFIX: \"00000000-0000-0000-0000-\",\r\n  SERVICE_ID: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0000\",\r\n  SERVICE_NAME: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0001\",\r\n  DEVICE_MODEL: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0002\",\r\n  WIFI_NAME: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0003\",\r\n  IP_ADDRESS: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0004\",\r\n  INPUT: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0005\",\r\n  NOTIFY_MESSAGE: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0006\",\r\n  INPUT_SEP: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0007\",\r\n  CUSTOM_COMMAND_INPUT: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0008\",\r\n  CUSTOM_COMMAND_NOTIFY: \"FD2B4448-AA0F-4A15-A62F-EB0BE77A0009\",\r\n  CUSTOM_INFO_LABEL: \"FD2BCCCA\",\r\n  CUSTOM_INFO_COUNT: \"FD2BCCAA0000\",\r\n  CUSTOM_INFO: \"FD2BCCCB\",\r\n  CUSTOM_COMMAND_LABEL: \"FD2BCCCC\",\r\n  CUSTOM_COMMAND_COUNT: \"FD2BCCAC0000\"\r\n};\r\n"],"sourceRoot":""}