(this.webpackJsonppibox=this.webpackJsonppibox||[]).push([[0],{104:function(e,t,n){e.exports=n(289)},109:function(e,t,n){},283:function(e,t){},284:function(e,t){},285:function(e,t){},286:function(e,t){},287:function(e,t){},288:function(e,t){},289:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(63),s=n.n(i),c=(n(109),n(65),n(7)),o=n(3),l=n.n(o),u=n(6),d=n(41),m=n(42),f=n(102),p=n(101),h=n(103),g=n(43),v=n.n(g),b=n(9);var E=n(64),C=n(10),_=function(){function e(t,n,a,r){var i=this;Object(d.a)(this,e),console.log(n),this.infoTexts=[],this.data=null,this.label=[],this.training=-1,this.videoPlaying=!1,this.trained=!1,this.inputFirst=!0,this.isTraining=!1,this.ipAddress=a,this.numClasses=2,this.completeModel=null,this.exampleCount=new Array(2).fill(0),this.lastChildAddClass=null,this.machineId=n,this.result=-1,this.resultConfidence=0,this.piboxPy="",this.setProbability=r,this.body=document.body,void 0!==t.current&&(this.body=t.current),this.bindPage(),this.video=document.createElement("img"),this.body.appendChild(this.video);for(var s=function(e){var t=document.createElement("div");i.lastChildAddClass=t,i.body.appendChild(t),t.style.marginBottom="10px";var n=document.createElement("button");n.innerText="\ub370\uc774\ud130 \ucd94\uac00 - \ud074\ub798\uc2a4 "+(e+1),n.addEventListener("mousedown",(function(){return i.training=e})),n.addEventListener("mouseup",(function(){return i.training=-1}));var a=document.createElement("span");a.innerText=" \ucd94\uac00\ub41c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",i.infoTexts.push(a)},c=0;c<this.numClasses;c++)s(c);this.video.src="http://"+this.ipAddress+":8000/stream.mjpg",this.video.width=224,this.video.height=224,this.video.crossOrigin="anonymous"}return Object(m.a)(e,[{key:"addTrainingData",value:function(e){this.training=e}},{key:"loadMobileNet",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.d("./assets/".concat(96,"_0.35/model.json"));case 2:return t=e.sent,n=t.getLayer("global_average_pooling2d_1"),e.abrupt("return",C.e({inputs:t.inputs,outputs:n.output}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"bindPage",value:function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadMobileNet();case 2:this.mobilenet=e.sent,this.mobilenet.trainable=!1,this.mobilenet.predict(C.k([1,96,96,3])),this.start();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){this.timer&&this.stop(),"video"===this.video.tagName?this.video.play():this.videoPlaying=!0,this.timer=requestAnimationFrame(this.animate.bind(this))}},{key:"stop",value:function(){"video"===this.video.tagName&&this.video.pause(),this.videoPlaying=!1,cancelAnimationFrame(this.timer)}},{key:"train",value:function(){var e=this;if(!this.isTraining&&0!==this.label.length){this.isTraining=!0;var t=document.getElementById("trainButton");t.src="img/plai_training.svg",console.log("train start");var n=null;this.model=C.g(),this.denseLayer1=C.c.dense({inputShape:this.mobilenet.outputs[0].shape.slice(1),units:100,activation:"relu",use_bias:!0,kernel_initializer:"varianceScaling"}),this.denseLayer2=C.c.dense({units:this.numClasses,activation:"softmax",use_bias:!1,kernel_initializer:"varianceScaling"}),this.model.add(this.denseLayer1),this.model.add(this.denseLayer2),this.model.compile({optimizer:C.j.adam(1e-4),loss:"categoricalCrossentropy",metrics:["accuracy"]}),this.label.forEach((function(t){var a=C.f(C.h([parseInt(t)],"int32"),e.numClasses);if(null===n)n=a;else{var r=n;n=r.concat(a,0),r.dispose()}})),this.model.fit(this.data,n,{epochs:20,batchSize:parseInt(.4*this.label.length),callbacks:{onBatchEnd:function(e,t){console.log("Accuracy",t.acc)}}}).then((function(n){console.log("Final accuracy",n.history.acc),e.trained=!0,e.isTraining=!1,t.src="img/plai_train.svg"}))}}},{key:"download",value:function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.completeModel=C.g(),this.completeModel.add(this.mobilenet),e.prev=2,this.completeModel.add(this.model),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(2),e.abrupt("return",!1);case 9:return e.prev=9,e.next=12,this.completeModel.save(C.b.http("http://tfjson-to-tflite.unicityclean.com/upload",{requestInit:{method:"POST",headers:{machine_id:this.machineId}}}));case 12:return e.abrupt("return",!0);case 15:return e.prev=15,e.t1=e.catch(9),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,this,[[2,6],[9,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"draw",value:function(){var e=Object(u.a)(l.a.mark((function e(t,n){var a,r,i,s,c,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(48,48,a=document.getElementById("canvas-"+n.toString()),(r=document.createElement("canvas")).width=48,r.height=48,r.className="cameraData",a.insertBefore(r,a.firstChild),a.childNodes.length>25&&a.removeChild(a.lastChild),i=r.getContext("2d"),s=new ImageData(48,48),c=t.dataSync(),o=0;o<2304;++o)u=4*o,s.data[u+0]=127*(c[3*o+0]+1),s.data[u+1]=127*(c[3*o+1]+1),s.data[u+2]=127*(c[3*o+2]+1),s.data[u+3]=255;i.putImageData(s,0,0);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addClass",value:function(){var e=this;this.exampleCount.push(0),this.numClasses+=1;var t=document.createElement("div");this.body.insertBefore(t,this.lastChildAddClass),t.style.marginBottom="10px";var n=document.createElement("button");n.innerText="\ub370\uc774\ud130 \ucd94\uac00 - \ud074\ub798\uc2a4 "+this.numClasses;var a=this.numClasses;n.addEventListener("mousedown",(function(){return e.training=a-1})),n.addEventListener("mouseup",(function(){return e.training=-1}));var r=document.createElement("span");r.innerText=" \ucd94\uac00\ub41c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",this.infoTexts.push(r)}},{key:"sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"animate",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,r,i,s,c,o,u,d,m=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.videoPlaying){e.next=27;break}if(t=C.a.fromPixels(this.video).resizeBilinear([96,96]),a=function(){return C.i((function(){return m.model.predict(m.mobilenet.predict(t.expandDims(0).toFloat().div(127).sub(1)))}))},-1===this.training){e.next=10;break}return r=t.expandDims(0).toFloat().div(127).sub(1),this.inputFirst?(this.data=this.mobilenet.predict(r),this.label.push(this.training),this.inputFirst=!1):(i=this.data,this.data=i.concat(this.mobilenet.predict(r),0),this.label.push(this.training),i.dispose()),e.next=8,this.draw(r.resizeBilinear([48,48]),this.training);case 8:this.exampleCount[this.training]+=1,r.dispose();case 10:if(!this.trained){e.next=24;break}return n=a(),s=n.as1D().argMax(),e.next=15,s.data();case 15:return c=e.sent[0],e.next=18,n.data();case 18:for(o=e.sent,this.setProbability(o),u=0;u<this.numClasses;u++)c===u?(this.infoTexts[u].style.fontWeight="bold",this.result=u,this.resultConfidence=100*o[u]):this.infoTexts[u].style.fontWeight="normal",this.exampleCount[u]>0&&(this.infoTexts[u].innerText=" ".concat(this.exampleCount[u]," examples - ").concat(Math.round(100*o[u]),"%"));s.dispose(),e.next=25;break;case 24:for(d=0;d<this.numClasses;d++)this.exampleCount[d]>0&&(this.infoTexts[d].innerText=" ".concat(this.exampleCount[d]," examples"));case 25:t.dispose(),null!=n&&n.dispose();case 27:return e.next=29,this.sleep(30);case 29:this.timer=requestAnimationFrame(this.animate.bind(this));case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),O=function(e){var t=e.bgcolor,n=e.completed,a={height:"100%",width:"".concat(n,"%"),backgroundColor:t,borderRadius:"inherit",textAlign:"right"};return r.a.createElement("div",{style:{height:20,width:"100%",backgroundColor:"#ffffff",borderRadius:50,margin:8}},r.a.createElement("div",{style:a},r.a.createElement("span",{style:{padding:5,color:"#ffffff",fontWeight:"bold"}},"".concat(n,"%"))))};function y(e){var t=Object(a.useState)(["Class 01","Class 02"]),n=Object(b.a)(t,2),i=n[0],s=n[1],o=Object(a.useState)(0),d=Object(b.a)(o,2),m=d[0],f=d[1],p=Object(a.useState)(0),h=Object(b.a)(p,2),g=h[0],v=h[1],C=Object(a.useState)([]),y=Object(b.a)(C,2),w=y[0],A=y[1],x=Object(a.useState)([]),N=Object(b.a)(x,2),k=N[0],I=N[1],P=Object(a.useState)(null),T=Object(b.a)(P,2),S=T[0],L=T[1],M=Object(a.useState)(80),F=Object(b.a)(M,2),D=F[0],B=(F[1],Object(a.useState)(!1)),j=Object(b.a)(B,2),U=j[0],R=j[1],G=Object(a.useState)("\ube14\ub85d\ucf54\ub4dc \uc5c5\ub85c\ub4dc"),W=Object(b.a)(G,2),V=W[0],H=W[1],z=Object(a.useState)(0),q=Object(b.a)(z,2),Y=q[0],X=q[1],K=Object(a.useState)([0,0]),J=Object(b.a)(K,2),Q=J[0],Z=J[1],$=Object(a.useRef)("");Object(a.useRef)("");Object(a.useEffect)((function(){void 0!==$.current&&""!==e.machineId&&(L(new _($,e.machineId,e.ipAddress,Z)),A(new Array(2).fill("")),I(new Array(2).fill("")))}),[$,e.machineId]);function ee(){var e="GPIO.setmode(GPIO.BCM)\npwm = pigpio.pi() \n    ";return 1===m?e+="\npwm.set_mode(18, pigpio.OUTPUT)\n":2===m?e+="\nGPIO.setup(18,GPIO.OUT) # Channel 1 Speed\nGPIO.setup(23,GPIO.OUT) # Direction of Channel 1\nGPIO.output(23,0) \nm1=GPIO.PWM(18,50)\nm1.start(0)\n":3===m&&3!==g&&(e+="\npix1 = neopixel.NeoPixel(board.D18,12)\n"),1===g?e+="\npwm.set_mode(12, pigpio.OUTPUT)\n":2===g?e+="\nGPIO.setup(12,GPIO.OUT) # Channel 2 Speed\nGPIO.setup(25,GPIO.OUT)\nGPIO.output(25,0) # Direction of Channel 2\nm2=GPIO.PWM(12,50)\nm2.start(0)\n":3===g&&3!==m&&(e+="\npix2 = neopixel.NeoPixel(board.D12,12)\n"),e}function te(){var e=0,t="    # From here. the block code\n    resultIndex = np.argmax(result)\n";return i.forEach((function(n,a){var r="",i=!1,s=!1;0===m?i=!0:1===m?isNaN(parseFloat(w[a]))?i=!0:r+="pwm.set_servo_pulsewidth(18,".concat(parseFloat(w[a])/180*2e3+500,") # 500 => 0 deg / 1500 => 90 deg / 2500 => 180 deg\n        "):2===m?r+="m1.ChangeDutyCycle(".concat(w[a][1],")\n        GPIO.output(23,").concat(w[a][0],") # Control direction\n        ").concat(2===g?"":"time.sleep(".concat(w[a][2],")\n        m1.ChangeDutyCycle(0)\n        GPIO.output(23,0)\n        "),"\n        "):3===m?r+="pix1.fill((".concat(w[a].r,",").concat(w[a].g,",").concat(w[a].b,"))\n        pix1.show()\n        "):i=!0,0===g?s=!0:1===g?isNaN(parseFloat(k[a]))?s=!0:r+="pwm.set_servo_pulsewidth(12,".concat(parseFloat(k[a])/180*2e3+500,") # 500 => 0 deg / 1500 => 90 deg / 2500 => 180 deg\n        "):2===g?r+="m2.ChangeDutyCycle(".concat(k[a][1],")\n        GPIO.output(25,").concat(k[a][0],") # Control direction\n        time.sleep(").concat(k[a][2],")\n        ").concat(2===m?"m1.ChangeDutyCycle(0)\n        GPIO.output(23,0)":"","\n        m2.ChangeDutyCycle(0)\n        GPIO.output(25,0)\n        "):3===g?r+="pix2.fill((".concat(k[a].r,",").concat(k[a].g,",").concat(k[a].b,"))\n        pix2.show()\n        "):s=!0,!0===i&&!0===s||(1===m&&""!==w[a]&&(0===e?(t+="\n    if ",e=1):t+="\n    elif "),t+="resultIndex == ".concat(a,":\n        ").concat(r,"\n        "))})),t}function ne(){var e="\n# Clean up\ncv2.destroyAllWindows()\nvideostream.stop()\n";return 1!==m&&1!==g||(e+="pwm.stop()\n"),2===m&&(e+="m1.stop()\n"),2===g&&(e+="m2.stop()\n"),e+="GPIO.cleanup()\n"}var ae=function(){var t=Object(u.a)(l.a.mark((function t(){var n,a,r,i,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H("\uc7a0\uc2dc\ub9cc \uae30\ub2e4\ub824\uc8fc\uc138\uc694..."),t.next=3,S.download();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:n=ee(),a=te(),r=ne(),i=new Blob(["\n## pibox TFLITE\nimport os\nimport argparse\nimport cv2\nimport numpy as np\nimport sys\nimport time\nfrom threading import Thread\nimport importlib.util\n\n## \ucd9c\ub825\uc744 \uc704\ud55c import\nimport RPi.GPIO as GPIO\nimport pigpio\nimport time\nimport board\nimport neopixel\n\n",n,"\n# \uce74\uba54\ub77c \uc624\ube0c\uc81d\ud2b8\nclass VideoStream:\n    def __init__(self,resolution=(320,240),framerate=3): # \uc6d0\ub798\ub294 640,480 \uadf8\ub9ac\uace0 30 framerate\n        # \ud30c\uc774 \uce74\uba54\ub77c\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4.\n        self.stream = cv2.VideoCapture(0)\n        ret = self.stream.set(cv2.CAP_PROP_FOURCC, cv2.VideoWriter_fourcc(*'MJPG'))\n        ret = self.stream.set(3,resolution[0])\n        ret = self.stream.set(4,resolution[1])\n            \n        # \uccab\ubc88\uc9f8 \uc0ac\uc9c4\uc744 \ubd88\ub7ec\uc635\ub2c8\ub2e4.\n        (self.grabbed, self.frame) = self.stream.read()\n\n\t    # \uba48\ucd9c \uc218 \uc788\ub3c4\ub85d stopped\ub97c \uc124\uc815\ud574\uc90d\ub2c8\ub2e4.\n        self.stopped = False\n\n    def start(self):\n\t    # \ube44\ub514\uc624 \uc2a4\ud2b8\ub9bc\uc5d0\uc11c \ud504\ub808\uc784\uc744 \uc77d\uc5b4\uc624\ub294 \uc4f0\ub808\ub4dc\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4.\n        Thread(target=self.update,args=()).start()\n        return self\n\n    def update(self):\n        # \uc4f0\ub808\ub4dc\uac00 \uba48\ucd9c \ub54c \uae4c\uc9c0 \uacc4\uc18d \uc2a4\ud2b8\ub9bc\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4.\n        while True:\n            # \uce74\uba54\ub77c\uac00 \uba48\ucd94\uba74 \uc2a4\ud2b8\ub9bc\uc744 \uba48\ucda5\ub2c8\ub2e4.\n            if self.stopped:\n                # \uce74\uba54\ub77c \ub9ac\uc18c\uc2a4\ub97c \ub2eb\uc2b5\ub2c8\ub2e4.\n                self.stream.release()\n                return\n\n            # \uba48\ucd98\uac83\uc774 \uc544\ub2c8\ub77c\uba74 \ud504\ub808\uc784\uc744 \uac00\uc838\uc635\ub2c8\ub2e4.\n            (self.grabbed, self.frame) = self.stream.read()\n\n    def read(self):\n\t    # \uac00\uc7a5 \ucd5c\uadfc \ud504\ub808\uc784\uc744 \uac00\uc838\uc635\ub2c8\ub2e4.\n        return self.frame\n\n    def stop(self):\n\t    # \uce74\uba54\ub77c \uc4f0\ub808\ub4dc\ub97c \uc815\uc9c0\ud569\ub2c8\ub2e4.\n        self.stopped = True\n\n# \uc785\ub825 \ud30c\ub77c\ubbf8\ud130\ub97c \uc815\uc758\ud569\ub2c8\ub2e4.\nparser = argparse.ArgumentParser()\nparser.add_argument('--modeldir', help='Folder the .tflite file is located in',\n                    required=True)\nparser.add_argument('--graph', help='Name of the .tflite file, if different than model.tflite',\n                    default='model.tflite')\nparser.add_argument('--labels', help='Name of the labelmap file, if different than labels.txt',\n                    default='labels.txt')\nparser.add_argument('--threshold', help='Minimum confidence threshold for displaying detected objects',\n                    default=0.5)\nparser.add_argument('--resolution', help='Desired webcam resolution in WxH. If the webcam does not support the resolution entered, errors may occur.',\n                    default='320x240') # \uc6d0\ub798\ub294 1280x720 \uc18d\ub3c4\ub97c \uc704\ud574 \ub0ae\ucda4\nparser.add_argument('--edgetpu', help='Use Coral Edge TPU Accelerator to speed up detection',\n                    action='store_true',default=False)\n\nargs = parser.parse_args()\n\nMODEL_NAME = args.modeldir\nGRAPH_NAME = args.graph\nLABELMAP_NAME = args.labels\nmin_conf_threshold = float(args.threshold)\nresW, resH = args.resolution.split('x')\nimW, imH = int(resW), int(resH) # \ub77c\uc988\ubca0\ub9ac\ud30c\uc774 \uc81c\ub85c + \ud30c\uc774\uce74\uba54\ub77c\uc5d0\uc11c\ub294 224,224 \uac00 \uc544\uc8fc \ucb10\uc5d0\uc5d0\uc5d0\ub054 \ube60\ub985\ub2c8\ub2e4.\nuse_TPU = args.edgetpu\n\n# \ud150\uc11c\ud50c\ub85c\uc6b0 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uac00\uc838\uc635\ub2c8\ub2e4.\n# \ud150\uc11c\ud50c\ub85c\uc6b0 \ub77c\uc774\ube0c\ub7ec\ub9ac\uac00 \uc5c6\ub2e4\uba74, tflite_runtime \uc744 \uac00\uc838\uc635\ub2c8\ub2e4.\n# \ucf54\ub784 TPU\ub97c \uc0ac\uc6a9\ud55c\ub2e4\uba74, TPU \uc6a9 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uac00\uc838\uc635\ub2c8\ub2e4. (import the load_delegate library)\npkg = importlib.util.find_spec('tensorflow')\nif pkg is None:\n    from tflite_runtime.interpreter import Interpreter\n    if use_TPU:\n        from tflite_runtime.interpreter import load_delegate\nelse:\n    from tensorflow.lite.python.interpreter import Interpreter\n    if use_TPU:\n        from tensorflow.lite.python.interpreter import load_delegate\n\n# TPU\ub97c \uc0ac\uc6a9\ud55c\ub2e4\uba74 TPU \ubaa8\ub378\uc744 \uac00\uc838\uc635\ub2c8\ub2e4.\nif use_TPU:\n    # 'edgetpu.tflite'\uac00 TPU\ub97c \uc0ac\uc6a9\ud560 \ub54c\uc758 \uae30\ubcf8 \uacbd\ub85c\uc785\ub2c8\ub2e4.\n    if (GRAPH_NAME == 'model.tflite'):\n        GRAPH_NAME = 'edgetpu.tflite'       \n\n# \uc791\uc5c5 \uacbd\ub85c\uc640 \ud604\uc7ac \uacbd\ub85c\ub97c \uc77c\uce58\uc2dc\ud0b5\ub2c8\ub2e4.\nCWD_PATH = os.getcwd()\n\n# \ubaa8\ub378 \uacbd\ub85c\ub97c \uc124\uc815\ud569\ub2c8\ub2e4.\nPATH_TO_CKPT = os.path.join(CWD_PATH,MODEL_NAME,GRAPH_NAME)\n\n# \ub77c\ubca8 \uacbd\ub85c\ub97c \uc124\uc815\ud569\ub2c8\ub2e4.\nPATH_TO_LABELS = os.path.join(CWD_PATH,MODEL_NAME,LABELMAP_NAME)\n\n# \ub77c\ubca8\uc744 \uac00\uc838\uc635\ub2c8\ub2e4.\nwith open(PATH_TO_LABELS, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# \uccab\ubc88\uc9f8 \ub77c\ubca8\uc774 ??? \uc778 \uacbd\uc6b0\uac00 \uc788\uc5b4 \uadf8\ub7f4 \uacbd\uc6b0 \uc81c\uac70\ud569\ub2c8\ub2e4.\nif labels[0] == '???':\n    del(labels[0])\n\n# \ud150\uc11c\ud50c\ub85c\uc6b0 \ubaa8\ub378\uc744 \uac00\uc838\uc635\ub2c8\ub2e4. TPU\ub97c \uc4f8 \uacbd\uc6b0 TPU \ubaa8\ub378\ub85c \uac00\uc838\uc635\ub2c8\ub2e4.\nif use_TPU:\n    interpreter = Interpreter(model_path=PATH_TO_CKPT,\n                              experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\n    print(PATH_TO_CKPT)\nelse:\n    interpreter = Interpreter(model_path=PATH_TO_CKPT)\n\ninterpreter.allocate_tensors()\n\n# \ub85c\ub4dc\ub41c \ubaa8\ub378\uc758 \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4.\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\nheight = input_details[0]['shape'][1]\nwidth = input_details[0]['shape'][2]\n#print(\"\uac00\ub85c\")\n#print(width)\n#print(\"\uc138\ub85c\")\n#print(height)\n# \uc785\ub825\uc774 \uc18c\uc218\uc778\uc9c0 \uc544\ub2cc\uc9c0 \ud310\ub2e8\ud569\ub2c8\ub2e4.\nfloating_model = (input_details[0]['dtype'] == np.float32)\n\ninput_mean = 127.5\ninput_std = 127.5\n\n# \uc5f0\uc0b0 \ud504\ub808\uc784\uc744 \uccb4\ud06c\ud558\uae30 \uc704\ud55c \ubcc0\uc218\ub97c \ud560\ub2f9\ud569\ub2c8\ub2e4.\nframe_rate_calc = 1\nfreq = cv2.getTickFrequency()\n\n# \uc0c1\ub2e8\uc5d0\uc11c \uc815\uc758\ud55c \ube44\ub514\uc624 \uc2a4\ud2b8\ub9bc\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4.\nvideostream = VideoStream(resolution=(imW,imH),framerate=30).start() \ntime.sleep(1)\n\n# \ud504\ub808\uc784\uc73c\ub85c \uc5f0\uc0b0\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4.\nwhile True:\n\n    # \uc5f0\uc0b0 \ud504\ub808\uc784\uc744 \uc704\ud55c \uc2dc\uac04 \uccb4\ud06c \ubcc0\uc218\ub97c \ud560\ub2f9\ud569\ub2c8\ub2e4.\n    t1 = cv2.getTickCount()\n\n    # \ube44\ub514\uc624\uc2a4\ud2b8\ub9bc\uc5d0\uc11c \ud504\ub808\uc784\uc744 \uc77d\uc5b4\uc635\ub2c8\ub2e4.\n    frame1 = videostream.read()\n\n    # \uc785\ub825\uc5d0 \ub123\uc744 \uc218 \uc788\ub3c4\ub85d \ud574\uc0c1\ub3c4\ub97c \ubcc0\uacbd\ud569\ub2c8\ub2e4.\n    frame = frame1.copy()\n    frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    # \uc704\uc5d0\uc11c input\uc744 224,224\ub85c \uc124\uc815\ud588\ub2e4\uba74 \uc544\ub798 \uc904\uc740 \ub118\uc5b4\uac00\ub3c4 \ub429\ub2c8\ub2e4..\n    frame_resized = cv2.resize(frame_rgb, (width, height)) \n    input_data = np.expand_dims(frame_resized, axis=0)\n\n    # \uc785\ub825\uc774 \uc18c\uc218\ub77c\uba74 \uc18c\uc218\ub85c \ubc14\uafd4\uc90d\ub2c8\ub2e4.\n    if floating_model:\n        input_data = (np.float32(input_data) - input_mean) / input_std\n\n    # \ub85c\ub4dc\ub41c \ubaa8\ub378\uc5d0 \uc785\ub825\uc744 \ub123\uc5b4 \uacb0\uacfc\ub97c \uac00\uc838\uc635\ub2c8\ub2e4.\n    interpreter.set_tensor(input_details[0]['index'],input_data)\n    interpreter.invoke()\n    result=interpreter.get_tensor(output_details[0]['index'])[0]\n    print(labels[np.argmax(result)])\n    #print(result)\n    # \ucd08\ub2f9 \uc5f0\uc0b0 \ud504\ub808\uc784\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4.\n    t2 = cv2.getTickCount()\n    time1 = (t2-t1)/freq\n    frame_rate_calc= 1/time1\n    #print(frame_rate_calc)\n",a,r],{type:"text/plain"}),(s=new FormData).append("pibox",i,"pibox.py");try{fetch("http://tfjson-to-tflite.unicityclean.com/pibox",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{machine_id:e.machineId},redirect:"follow",referrer:"no-referrer",body:s}).then((function(){e.sendCommand(e.uploadUUID)})).then((function(){H("\ube14\ub85d\ucf54\ub4dc \uc5c5\ub85c\ub4dc")}))}catch(c){console.log(c),H("\uc5c5\ub85c\ub4dc \uc2e4\ud328, \ub098\uc911\uc5d0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}return t.abrupt("return",i);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),re=function(t){if(2===m||2===g)alert("\uc9c0\uae08\uc740 \uc11c\ubcf4\ubaa8\ud130\uc640 LED\ub9cc \ub3d9\uc791\ud574 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4!");else if(Y+1300<Date.now()){var n="http://"+e.ipAddress+":8000/move.html?",a="None";if(!isNaN(parseFloat(w[t]))&&1==m||!isNaN(parseFloat(w[t].r))&&3==m)switch(m){case 1:a="servo_"+w[t];break;case 3:a="led_"+w[t].r+"_"+w[t].g+"_"+w[t].b}var r="None";if(!isNaN(parseFloat(k[t]))&&1==g||!isNaN(parseFloat(k[t].r))&&3==g)switch(g){case 1:r="servo_"+k[t];break;case 3:r="led_"+k[t].r+"_"+k[t].g+"_"+k[t].b}fetch(n+"ch1="+a+"&ch2="+r),X(Date.now())}};!function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){U&&(2===m||2===g?(alert("\uc9c0\uae08\uc740 \uc11c\ubcf4\ubaa8\ud130\uc640 LED\ub9cc \ub3d9\uc791\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4!"),R(!1)):D<=S.resultConfidence&&-1!==S.result&&re(S.result))}),100);return r.a.createElement("div",{className:"connect-panel panel"},r.a.createElement("img",{onClick:function(){return e.setIsBlockCoding()},src:"img/icon_arrow_back.svg",className:"Icon-arrow_back-blockcode"}),null,r.a.createElement("div",{className:"training-label"},"\ud559\uc2b5\ud558\uae30"),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{width:"32.3%",marginLeft:"8%"}},r.a.createElement("div",{style:{position:"fixed"}},r.a.createElement("div",{className:"block-2"},r.a.createElement("div",{className:"block",ref:$}),r.a.createElement("div",{style:{marginLeft:"20px"}},r.a.createElement("img",{src:"img/plai_train.svg",id:"trainButton",onClick:function(){return S.train()},className:"plai-train"})),r.a.createElement("div",{style:{marginLeft:"20px"}},r.a.createElement("img",{style:{cursor:"pointer"},src:U?"img/plai_move_on.svg":"img/plai_move_off.svg",onClick:function(){return R(!U)}}))))),r.a.createElement("div",{style:{width:"67.7%",marginRight:"8%"}},r.a.createElement("div",null,r.a.createElement("div",{className:"blocks",style:{display:"inline",width:"49%",marginLeft:"1%"}},r.a.createElement("div",{className:"block",id:"output-type-block"},r.a.createElement("div",{className:"output-type"},r.a.createElement("div",{className:"Out-put-01"},"Output 01"),r.a.createElement("div",{className:"output-circles"},r.a.createElement("div",{style:{marginLeft:"12%"},onClick:function(){1===m?(f(0),A((function(e){return new Array(e.length).fill("")}))):(f(1),A((function(e){return new Array(e.length).fill("0")})))}},r.a.createElement("img",{src:1===m?"img/servomotor_picked.svg":"img/servomotor.svg",alt:"servomotor",style:{cursor:"pointer"}})),r.a.createElement("div",{style:{marginLeft:"40px",marginRight:"40px"},onClick:function(){2===m?(f(0),A((function(e){return new Array(e.length).fill("")}))):(f(2),A((function(e){return new Array(e.length).fill(["0","50","0.5"])})))}},r.a.createElement("img",{style:{cursor:"pointer"},src:2===m?"img/dcmotor_picked.svg":"img/dcmotor.svg",alt:"dcmotor"})),r.a.createElement("div",{style:{marginRight:"12%"},onClick:function(){3===m?(f(0),A((function(e){return new Array(e.length).fill("")}))):3!==g?(f(3),A((function(e){return new Array(e.length).fill({r:255,g:255,b:255,a:1})}))):alert("LED \ucd9c\ub825\uc740 1\uac1c\uc758 \ucc44\ub110\ub9cc \uac00\ub2a5\ud569\ub2c8\ub2e4.")}},r.a.createElement("img",{style:{cursor:"pointer"},src:3===m?"img/led_picked.svg":"img/led.svg",alt:"led"})))),r.a.createElement("div",{className:"output-type",style:{marginLeft:"80px"}},r.a.createElement("div",{className:"Out-put-01"},"Output 02"),r.a.createElement("div",{className:"output-circles"},r.a.createElement("div",{style:{marginLeft:"12%"},onClick:function(){1===g?(v(0),I((function(e){return new Array(e.length).fill("")}))):(v(1),I((function(e){return new Array(e.length).fill("0")})))}},r.a.createElement("img",{style:{cursor:"pointer"},src:1===g?"img/servomotor_picked.svg":"img/servomotor.svg",alt:"servomotor"})),r.a.createElement("div",{style:{marginLeft:"40px",marginRight:"40px"},onClick:function(){2===g?(v(0),I((function(e){return new Array(e.length).fill("")}))):(v(2),I((function(e){return new Array(e.length).fill(["0","50","0.5"])})))}},r.a.createElement("img",{style:{cursor:"pointer"},src:2===g?"img/dcmotor_picked.svg":"img/dcmotor.svg",alt:"dcmotor"})),r.a.createElement("div",{style:{marginRight:"12%"},onClick:function(){3===g?(v(0),I((function(e){return new Array(e.length).fill("")}))):3!==m?(v(3),I((function(e){return new Array(e.length).fill({r:255,g:255,b:255,a:1})}))):alert("LED \ucd9c\ub825\uc740 1\uac1c\uc758 \ucc44\ub110\ub9cc \uac00\ub2a5\ud569\ub2c8\ub2e4.")}},r.a.createElement("img",{style:{cursor:"pointer"},src:3===g?"img/led_picked.svg":"img/led.svg",alt:"dcmotor"}))))))),r.a.createElement("div",{className:"label-output"},r.a.createElement("div",{className:"blocks-container"},r.a.createElement("div",null,i.map((function(e,t){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"class-object"},r.a.createElement("div",{className:"class-object-left"},r.a.createElement("div",{className:"block"},r.a.createElement("span",{className:"class-object-label"},e),r.a.createElement(O,{bgcolor:"#00695c",completed:Math.floor(100*Q[t])})),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{marginLeft:"10px",marginRight:"10px",position:"relative",top:"123px"}},r.a.createElement("img",{src:"img/icon_video.svg",className:"Icon-awesome-video",onMouseDown:function(){S.addTrainingData(t)},onMouseUp:function(){S.addTrainingData(-1)},onMouseLeave:function(){S.addTrainingData(-1)}})),r.a.createElement("div",{className:"training-images",id:"canvas-"+t.toString()}))),r.a.createElement("hr",{size:"2",width:"60px",noshade:"true",className:"class-object-connecting"}),r.a.createElement("div",{className:"class-object-right"},r.a.createElement("span",{className:"class-output-settings"},function(e){return r.a.createElement("div",{className:"showOutputType",key:e},r.a.createElement("span",null,r.a.createElement("div",{className:"class-object-label",style:{marginTop:"9px",marginBottom:"10px"}},"Output 1"),1===m?r.a.createElement("div",{className:"servomotor"},r.a.createElement("p",null,"\ubaa8\ud130\uc758 \ub0a0\uac1c\uac00 \uc6c0\uc9c1\uc774\ub294 \uac01\ub3c4\ub97c \uc124\uc815\ud574\uc8fc\uc138\uc694.",r.a.createElement("br",null)," ( 0 ~ 180 )"),r.a.createElement("input",{style:{height:30},onChange:function(t){var n=t.target.value;A((function(t){var a=Object(c.a)(t);return a[e]=n>180?180:n<0?0:n,a}))},type:"number",value:w[e]||""})):2===m?r.a.createElement("div",{style:{display:"inline"}},r.a.createElement("select",{style:{backgroundColor:"#ffffff",fontSize:15,borderRadius:2},onChange:function(t){var n=t.target.value;A((function(t){var a=Object(c.a)(t);return a[e]=[n,a[e][1],a[e][2]],a}))},defaultValue:w[e][0]},r.a.createElement("option",{value:"0"},"\uc815\ubc29\ud5a5"),r.a.createElement("option",{value:"1"},"\uc5ed\ubc29\ud5a5")),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("h5",{style:{textAlign:"center"}},"\uc18d\ub3c4 ( 0 ~ 100 ) "),r.a.createElement("input",{style:{height:30},onChange:function(t){var n=t.target.value;A((function(t){var a=Object(c.a)(t);return a[e]=[a[e][0],n,a[e][2]],a}))},type:"number",value:w[e][1]})),r.a.createElement("div",{style:{marginLeft:"10%"}},r.a.createElement("h5",{style:{textAlign:"center"}},"\uc2dc\uac04 ( 1 ","=>"," 1\ucd08 ) "),r.a.createElement("input",{style:{height:30},onChange:function(t){var n=t.target.value;A((function(t){var a=Object(c.a)(t);return a[e]=[a[e][0],a[e][1],n],a}))},type:"number",value:w[e][2]})))):3===m?r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(E.SliderPicker,{color:w[e],onChange:function(t){A((function(n){var a=Object(c.a)(n);return a[e]=t.rgb,a}))}})):r.a.createElement("div",{style:{padding:"10px"}},"\ucd9c\ub825 \uc885\ub958\ub97c \uba3c\uc800 \uc120\ud0dd\ud558\uc138\uc694")),r.a.createElement("span",null,r.a.createElement("div",{className:"class-object-label",style:{marginTop:"9px",marginBottom:"10px"}},"Output 2"),1===g?r.a.createElement("div",{className:"servomotor"},r.a.createElement("p",null,"\ubaa8\ud130\uc758 \ub0a0\uac1c\uac00 \uc6c0\uc9c1\uc774\ub294 \uac01\ub3c4\ub97c \uc124\uc815\ud574\uc8fc\uc138\uc694.",r.a.createElement("br",null),"( 0 ~ 180 )"),r.a.createElement("input",{style:{height:30},onChange:function(t){var n=t.target.value;I((function(t){var a=Object(c.a)(t);return a[e]=n>180?180:n<0?0:n,a}))},type:"number",value:k[e]||""})):2===g?r.a.createElement("div",{style:{display:"inline"}},r.a.createElement("select",{style:{backgroundColor:"#ffffff",fontSize:15,borderRadius:2},onChange:function(t){var n=t.target.value;I((function(t){var a=Object(c.a)(t);return a[e]=[n,a[e][1],a[e][2]],a}))},defaultValue:k[e][0]},r.a.createElement("option",{value:"0"},"\uc815\ubc29\ud5a5"),r.a.createElement("option",{value:"1"},"\uc5ed\ubc29\ud5a5")),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("h5",{style:{textAlign:"center"}},"\uc18d\ub3c4 ( 0 ~ 100 ) "),r.a.createElement("input",{style:{height:30},onChange:function(t){var n=t.target.value;I((function(t){var a=Object(c.a)(t);return a[e]=[a[e][0],n,a[e][2]],a}))},type:"number",value:k[e][1]})),r.a.createElement("div",{style:{marginLeft:"10%"}},r.a.createElement("h5",{style:{textAlign:"center"}},"\uc2dc\uac04 ( 1 ","=>"," 1\ucd08 ) "),r.a.createElement("input",{style:{height:30},onChange:function(t){var n=t.target.value;I((function(t){var a=Object(c.a)(t);return a[e]=[a[e][0],a[e][1],n],a}))},type:"number",value:k[e][2]})))):3===g?r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(E.SliderPicker,{color:k[e],onChangeComplete:function(t){I((function(n){var a=Object(c.a)(n);return a[e]=t.rgb,a}))}})):r.a.createElement("div",{style:{padding:"10px"}},"\ucd9c\ub825 \uc885\ub958\ub97c \uba3c\uc800 \uc120\ud0dd\ud558\uc138\uc694")),r.a.createElement("span",null,r.a.createElement("button",{className:"test-move",onClick:function(){return re(e)}},"\ud14c\uc2a4\ud2b8\ud558\uae30")))}(t)))))}))))))),r.a.createElement("div",{className:"block",style:{textAlign:"center"}},r.a.createElement("img",{style:{margin:"0px auto",marginTop:"30px",cursor:"pointer"},onClick:function(){return S.addClass(),s((function(e){return[].concat(Object(c.a)(e),["Class ".concat(i.length+1)])})),A((function(e){return[].concat(Object(c.a)(e),[""])})),I((function(e){return[].concat(Object(c.a)(e),[""])})),void Z((function(e){return[].concat(Object(c.a)(e),[0])}))},src:"img/add_class.svg"})),r.a.createElement("div",{className:"block"},r.a.createElement("img",{style:{margin:"0px auto",marginTop:"30px",cursor:"pointer"},onClick:function(){return"\uc7a0\uc2dc\ub9cc \uae30\ub2e4\ub824\uc8fc\uc138\uc694..."!==V?ae():null},src:"\uc7a0\uc2dc\ub9cc \uae30\ub2e4\ub824\uc8fc\uc138\uc694..."===V?"img/blockcode_uploading_button.svg":"img/blockcode_upload_button.svg"})))}var w=n(4),A=n.n(w),x=function(e){function t(e){var n;for(var a in Object(d.a)(this,t),(n=Object(f.a)(this,Object(p.a)(t).call(this,e))).connectDevice=function(){navigator.bluetooth.requestDevice({filters:[{services:[A.a.SERVICE_ID]}]}).then((function(e){return e.gatt.connect()})).then((function(e){return n.setState({serverId:e.device.id}),e.getPrimaryService(A.a.SERVICE_ID)})).then((function(e){return n.state.isIphone?(console.log("ios webBLE"),n.webBleConnect(e)):e.getCharacteristics()})).then(function(){var e=Object(u.a)(l.a.mark((function e(t){var a,r,i,s,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Connected!"),a=t,n.setState({isConnected:!0}),r=[{preset:!0,uuid:"",label:"Device ID",value:n.state.serverId},{preset:!0,uuid:A.a.DEVICE_MODEL,label:"Model",value:" "},{preset:!0,uuid:A.a.WIFI_NAME,label:"Wifi",value:"..."},{preset:!0,uuid:A.a.IP_ADDRESS,label:"IP Address",value:"..."}],e.next=6,n.subscribeCharacteristic(A.a.WIFI_NAME,r,a);case 6:return e.next=8,n.subscribeCharacteristic(A.a.IP_ADDRESS,r,a);case 8:return e.next=10,n.readInfoCharacteristic(A.a.DEVICE_MODEL,r,a);case 10:return e.next=12,n.subscribeCharacteristic(A.a.NOTIFY_MESSAGE,r,a);case 12:return e.next=14,n.subscribeCharacteristic(A.a.CUSTOM_COMMAND_NOTIFY,r,a);case 14:a.filter((function(e){return e.uuid.indexOf(A.a.CUSTOM_INFO_LABEL)>=0})).map((function(e){return r.push({uuid:e.uuid.replace(A.a.CUSTOM_INFO_LABEL,A.a.CUSTOM_INFO),uuid_label:e.uuid,label:"-",value:""})})),i=0;case 16:if(!(i<r.length)){e.next=26;break}if(!r[i].preset){e.next=19;break}return e.abrupt("continue",23);case 19:return e.next=21,n.readInfoCharacteristic(r[i].uuid_label,r,a);case 21:return e.next=23,n.subscribeCharacteristic(r[i].uuid,r,a);case 23:i++,e.next=16;break;case 26:s=[],a.filter((function(e){return e.uuid.indexOf(A.a.CUSTOM_COMMAND_LABEL)>=0})).map((function(e){return s.push({uuid:e.uuid,label:"..."})})),c=s,o=0;case 30:if(!(o<c.length)){e.next=36;break}return e.next=33,n.readCommandLabel(c[o].uuid,c,a);case 33:o++,e.next=30;break;case 36:n.setState({characteristicsList:a,infoList:r,commandList:c});case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(console.log)},n.readCommandLabel=function(e,t,a){return new Promise((function(r){n.getCharacteristicInit(e,a).readValue().then((function(e){return e.buffer})).then(n.ab2str).then((function(a){var i=t;i.find((function(t){return t.uuid===e})).label=a,n.setState({commandList:i},r())}))}))},n.readInfoCharacteristic=function(e,t,a){return new Promise((function(r){n.getCharacteristicInit(e,a).readValue().then((function(e){return e.buffer})).then(n.ab2str).then((function(a){var i=t;i.find((function(t){return t.uuid===e}))&&(i.find((function(t){return t.uuid===e})).value=a),i.find((function(t){return t.uuid_label===e}))&&(i.find((function(t){return t.uuid_label===e})).label=a),i!==n.state.infoList?n.setState({infoList:i},r()):r()}))}))},n.subscribeCharacteristic=function(e,t,a){return new Promise(function(){var r=Object(u.a)(l.a.mark((function r(i){return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.getCharacteristicInit(e,a).addEventListener("characteristicvaluechanged",(function(a){if(a.target.uuid===A.a.NOTIFY_MESSAGE){var r=n.ab2str(a.target.value.buffer);g.notify.show(r,"custom",3e3,"teal")}else if(a.target.uuid===A.a.CUSTOM_COMMAND_NOTIFY){var i=n.ab2str(a.target.value.buffer);if(n.state.commandOutputShouldRefresh)n.setState({commandOutputShouldRefresh:!1,commandOutput:""},(function(){var e=n.state.commandOutput+i;e.endsWith("&#&")&&(e=e.replace("&#&",""),n.setState({commandOutputShouldRefresh:!0})),n.setState({commandOutput:e})}));else{var s=n.state.commandOutput+i;s.endsWith("&#&")&&(s=s.replace("&#&",""),n.setState({commandOutputShouldRefresh:!0})),n.setState({commandOutput:s})}}else{var c=n.ab2str(a.target.value.buffer),o=t;o.find((function(t){return t.uuid===e}))&&(o.find((function(t){return t.uuid===e})).value=c),o.find((function(t){return t.uuid_label===e}))&&(o.find((function(t){return t.uuid_label===e})).label=c),n.setState({infoList:o})}})),r.next=3,n.getCharacteristicInit(e,a).startNotifications();case 3:i();case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},n.webBleConnect=function(e){return new Promise(function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getCharacteristic(A.a.PREFIX+A.a.CUSTOM_INFO_COUNT).then((function(e){return e.readValue()})).then((function(e){return e.buffer})).then(n.ab2str).then(parseInt).then((function(e){console.log("custom-info-count "+e),n.setState({customInfoCount:e})}));case 2:return t.next=4,e.getCharacteristic(A.a.PREFIX+A.a.CUSTOM_COMMAND_COUNT).then((function(e){return e.readValue()})).then((function(e){return e.buffer})).then(n.ab2str).then(parseInt).then((function(t){console.log("custom-command-count "+t),n.setState({customCommandCount:t},(function(){for(var t=[],r=0;r<n.state.customInfoCount;r++){var i=(r+1).toString(16);i="0".repeat(4-i.length)+i,t.push(A.a.PREFIX+A.a.CUSTOM_INFO+i),t.push(A.a.PREFIX+A.a.CUSTOM_INFO_LABEL+i)}for(var s=[],o=0;o<n.state.customCommandCount;o++){var l=(o+1).toString(16);l="0".repeat(4-l.length)+l,s.push(A.a.PREFIX+A.a.CUSTOM_COMMAND_LABEL+l)}a(Promise.all([e.getCharacteristic(A.a.SERVICE_NAME),e.getCharacteristic(A.a.DEVICE_MODEL),e.getCharacteristic(A.a.WIFI_NAME),e.getCharacteristic(A.a.IP_ADDRESS),e.getCharacteristic(A.a.NOTIFY_MESSAGE),e.getCharacteristic(A.a.INPUT_SEP),e.getCharacteristic(A.a.CUSTOM_COMMAND_INPUT),e.getCharacteristic(A.a.CUSTOM_COMMAND_NOTIFY)].concat(Object(c.a)(t.map((function(t){return e.getCharacteristic(t)}))),Object(c.a)(s.map((function(t){return e.getCharacteristic(t)}))))))}))}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},n.ab2str=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))},n.getCharacteristic=function(e){return n.state.characteristicsList.find((function(t){return t.uuid===e}))},n.getCharacteristicInit=function(e,t){return t.find((function(t){return t.uuid===e}))},n.inputWifi=function(){n.setState({key:n.state.key.trim().replace(/\|/g,"*"),ssid:n.state.ssid.trim().replace(/\|/g,"*"),password:n.state.password.trim().replace(/\|/g,"*")},(function(){var e;if(""===n.state.ssid&&(e="SSID cannot be empty."),""===n.state.password&&(e="Password cannot be empty."),e)g.notify.show(e,"custom",3e3,"teal");else{n.setState({wifiLock:!0},(function(){return setTimeout((function(){n.setState({wifiLock:!1,wifiReset:!1})}),4e3)}));var t=n.str2abs("".concat(n.state.key,"%&%").concat(n.state.ssid,"%&%").concat(n.state.password,"&#&"));n.sendSeparately(t,A.a.INPUT_SEP)}}))},n.sendCommand=function(e){var t=n.str2abs("".concat(n.state.key,"%&%").concat(e.slice(-4),"&#&"));n.sendSeparately(t,A.a.CUSTOM_COMMAND_INPUT)},n.sendSeparately=function(){var e=Object(u.a)(l.a.mark((function e(t,a){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=l.a.keys(t);case 1:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.next=5,n.getCharacteristic(a).writeValue(t[r]);case 5:return e.next=7,n.wait(.4);case 7:e.next=1;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.wait=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e(!0)}),1e3*t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.waitCamera=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,void 0===n.state.infoList.find((function(e){return"IP Address"===e.label}))||""===n.state.infoList.find((function(e){return"IP Address"===e.label})).value){e.next=10;break}case 2:if(!t){e.next=7;break}return e.next=5,fetch("http://"+n.state.infoList.find((function(e){return"IP Address"===e.label})).value+":8000/index.html").then(function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.ok){e.next=5;break}return e.next=3,n.wait(.5);case 3:e.next=6;break;case 5:t=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.wait(.5);case 2:case"end":return e.stop()}}),e)}))));case 5:e.next=2;break;case 7:return e.abrupt("return",!0);case 10:return alert("\uc640\uc774\ud30c\uc774\uac00 \uc5f0\uacb0\ub418\uc5b4\uc788\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)}))),n.str2abs=function(e){for(var t="",n=0;n<e.length;n++)""===t?t=e.charCodeAt(n).toString(16):t+=","+e.charCodeAt(n).toString(16);for(var a=t.split(","),r=[];a.length>0;){var i=a.splice(0,20).join(",");r.push(new Uint8Array(i.match(/[\da-f]{2}/gi).map((function(e){return parseInt(e,16)}))).buffer)}return r},n.setIsBlockCodingToFalse=function(){n.setState({isBlockCoding:!1}),n.sendCommand(n.state.commandList.find((function(e){return"stop"===e.label})).uuid)},n.state={supportBluetooth:Boolean(window.navigator.bluetooth),isConnected:!1,serverId:"",ssid:"",password:"",key:"pibox",wifiLock:!1,characteristicsList:[],infoList:[],commandList:[],isBlockCoding:!1,commandOutput:"",commandOutputShouldRefresh:!1,loading:null,charLength:-1,customInfoCount:0,customCommandCount:0,wifiReset:!1,isAndroid:navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Adr")>-1,isIphone:navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iphone")>-1,wifiConnected:!1},A.a)A.a[a]=A.a[a].toLowerCase();return n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"BluetoothConnect"},r.a.createElement("div",{id:"app"},r.a.createElement(v.a,null),r.a.createElement("img",{src:"img/logo.svg",className:"logo"}),r.a.createElement("div",{className:"panel-container"},this.state.supportBluetooth?null:r.a.createElement("div",{className:"connect-panel panel"},r.a.createElement("div",{className:"panel-title"},"Cannot find web bluetooth."),r.a.createElement("p",null,"Please make sure your device and browser support web bluetooth. Please visit"," ",r.a.createElement("a",{href:"https://github.com/WebBluetoothCG/web-bluetooth/blob/master/implementation-status.md",target:"_brank"},"Here")," ","to check web-bluetooth compatibility.")),!this.state.isConnected&&this.state.supportBluetooth?r.a.createElement("div",{className:"connect-panel panel"},r.a.createElement("img",{src:"img/icon_arrow_back.svg",className:"Icon-arrow_back"}),r.a.createElement("div",{className:"character-button"},r.a.createElement("img",{src:"img/character.svg",className:"character"}),r.a.createElement("div",{className:"Look-it-up"},"Look it up!"),r.a.createElement("div",{className:"PLAi-Bluetooth-"},"PLAi\ub97c \uc6c0\uc9c1\uc77c Bluetooth\ub97c \ucc3e\uc544\ubcfc\uae4c\uc694?"),r.a.createElement("div",{onClick:this.connectDevice},r.a.createElement("img",{src:"img/bluetooth_button.svg",className:"bluetooth_button"})))):null,(this.state.isConnected,null),this.state.isConnected&&(void 0===this.state.infoList.find((function(e){return"IP Address"===e.label}))||""===this.state.infoList.find((function(e){return"IP Address"===e.label})).value)||this.state.wifiReset?r.a.createElement("div",{className:"wifi-panel panel"},r.a.createElement("img",{src:"img/icon_arrow_back.svg",className:"Icon-arrow_back"}),r.a.createElement("div",{className:"WiFi-password-container"},r.a.createElement("div",{className:"wifi-setting-title"},r.a.createElement("span",{className:"WiFi-"},"WiFi \uc124\uc815"),r.a.createElement("img",{src:"img/character2.svg",className:"character2"})),r.a.createElement("div",{className:"wifi-name-container"},r.a.createElement("div",null,r.a.createElement("span",{className:"Wifi-Name"},"WiFi Name"),r.a.createElement("input",{className:"wifi-name-input",placeholder:"  \uc640\uc774\ud30c\uc774 \uc774\ub984(SSID)",value:this.state.ssid,onChange:function(t){return e.setState({ssid:t.target.value})}})),r.a.createElement("div",null,r.a.createElement("span",{className:"Wifi-Password"},"WiFi Password"),r.a.createElement("input",{className:"wifi-password-input",placeholder:"  \uc640\uc774\ud30c\uc774 \ube44\ubc00\ubc88\ud638",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value.replace(/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/g,"")})},type:"password"}))),r.a.createElement("div",null,r.a.createElement("img",{className:"wifi-button",onClick:this.inputWifi,disabled:this.state.wifiLock,src:this.state.wifiLock?"img/wifing_button.svg":"img/wifi_button.svg"})))):null,!this.state.isConnected||void 0===this.state.infoList.find((function(e){return"IP Address"===e.label}))||""===this.state.infoList.find((function(e){return"IP Address"===e.label})).value||this.state.wifiConnected||this.state.wifiReset?null:r.a.createElement("div",{className:"connect-panel panel"},r.a.createElement("img",{src:"img/icon_arrow_back.svg",onClick:function(){return e.setState({wifiReset:!0})},className:"Icon-arrow_back"}),r.a.createElement("div",{className:"character-button"},r.a.createElement("img",{src:"img/character2.svg",className:"character"}),r.a.createElement("div",{className:"Look-it-up"},"WiFi \uc124\uc815\uc774 \uc644\ub8cc \ub418\uc5c8\uc2b5\ub2c8\ub2e4."),r.a.createElement("div",{className:"PLAi-Bluetooth-"},"PLAi\uc640 \ud568\uaed8 \ub180\uc544\ubcfc\uae4c\uc694?"),r.a.createElement("div",{onClick:function(){return e.setState({wifiConnected:!0})}},r.a.createElement("img",{src:"img/wifi_next.svg",className:"bluetooth_button"}))))),this.state.isConnected&&!this.state.isBlockCoding&&this.state.wifiConnected&&!this.state.wifiReset?r.a.createElement("div",{className:"connect-panel panel"},r.a.createElement("img",{src:"img/icon_arrow_back.svg",onClick:function(){return e.setState({wifiReset:!0})},className:"Icon-arrow_back"}),r.a.createElement("div",{className:"character-button"},r.a.createElement("img",{src:"img/plai_character.svg",className:"character"}),this.state.isConnected&&void 0!==this.state.infoList.find((function(e){return"IP Address"===e.label}))&&""!==this.state.infoList.find((function(e){return"IP Address"===e.label})).value&&void 0!==this.state.infoList.find((function(e){return"Machine ID"===e.label}))&&""!==this.state.infoList.find((function(e){return"Machine ID"===e.label})).value&&!this.state.isBlockCoding&&this.state.wifiConnected?r.a.createElement("div",{onClick:Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sendCommand(e.state.commandList.find((function(e){return"camStart"===e.label})).uuid),t.next=3,e.wait(2);case 3:return t.next=5,e.waitCamera();case 5:e.setState({isBlockCoding:!0});case 6:case"end":return t.stop()}}),t)})))},r.a.createElement("img",{src:"img/start_blockcode_button.svg",className:"bluetooth_button"})):r.a.createElement("div",null,r.a.createElement("img",{src:"img/start_blockcode_button_not_available.svg",className:"bluetooth_button"})),r.a.createElement("div",{onClick:Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sendCommand(e.state.commandList.find((function(e){return"start"===e.label})).uuid),t.next=3,e.wait(.5);case 3:case"end":return t.stop()}}),t)})))},r.a.createElement("img",{src:"img/start_plai_button.svg",className:"bluetooth_button"})),r.a.createElement("div",{onClick:Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sendCommand(e.state.commandList.find((function(e){return"stop"===e.label})).uuid),e.setState({isBlockCoding:!1}),t.next=4,e.wait(.5);case 4:case"end":return t.stop()}}),t)})))},r.a.createElement("img",{src:"img/stop_plai_button.svg",className:"bluetooth_button"})),r.a.createElement("div",{onClick:Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sendCommand(e.state.commandList.find((function(e){return"reboot"===e.label})).uuid),t.next=3,e.wait(.5);case 3:case"end":return t.stop()}}),t)})))},r.a.createElement("img",{src:"img/plai_reboot_button.svg",className:"bluetooth_button"})))):null,this.state.isConnected&&this.state.isBlockCoding&&this.state.wifiConnected&&!this.state.wifiReset?r.a.createElement("div",{className:"panel-container"},r.a.createElement(y,{ipAddress:void 0===this.state.infoList.find((function(e){return"IP Address"===e.label}))?"":this.state.infoList.find((function(e){return"IP Address"===e.label})).value,machineId:void 0===this.state.infoList.find((function(e){return"Machine ID"===e.label}))?"":this.state.infoList.find((function(e){return"Machine ID"===e.label})).value,sendCommand:this.sendCommand,uploadUUID:this.state.commandList.find((function(e){return"upload"===e.label})).uuid,setIsBlockCoding:this.setIsBlockCodingToFalse})):null,r.a.createElement("div",{className:"copyright"},"PiBox . Open source under GPL-3.0 license.")))}}]),t}(r.a.Component);var N=function(){return r.a.createElement(x,null)};s.a.render(r.a.createElement(N,null),document.getElementById("root")||document.createElement("div"))},4:function(e,t){e.exports={PREFIX:"00000000-0000-0000-0000-",SERVICE_ID:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0000",SERVICE_NAME:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0001",DEVICE_MODEL:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0002",WIFI_NAME:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0003",IP_ADDRESS:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0004",INPUT:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0005",NOTIFY_MESSAGE:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0006",INPUT_SEP:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0007",CUSTOM_COMMAND_INPUT:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0008",CUSTOM_COMMAND_NOTIFY:"FD2B4448-AA0F-4A15-A62F-EB0BE77A0009",CUSTOM_INFO_LABEL:"FD2BCCCA",CUSTOM_INFO_COUNT:"FD2BCCAA0000",CUSTOM_INFO:"FD2BCCCB",CUSTOM_COMMAND_LABEL:"FD2BCCCC",CUSTOM_COMMAND_COUNT:"FD2BCCAC0000"}},65:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.de1f07b1.chunk.js.map